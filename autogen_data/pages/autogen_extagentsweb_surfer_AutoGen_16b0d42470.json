{
  "url": "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.web_surfer.html",
  "title": "autogen_ext.agents.web_surfer — AutoGen",
  "content": "Bases: BaseChatAgent, Component[MultimodalWebSurferConfig]\n\nMultimodalWebSurfer is a multimodal agent that acts as a web surfer that can search the web and visit web pages.\n\nIt launches a chromium browser and allows the playwright to interact with the web browser and can perform a variety of actions. The browser is launched on the first call to the agent and is reused for subsequent calls.\n\nIt must be used with a multimodal model client that supports function/tool calling, ideally GPT-4o currently.\n\nIf this is the first call, the browser is initialized and the page is loaded. This is done in _lazy_init(). The browser is only closed when close() is called.\n\nThe method _generate_reply() is called, which then creates the final response as below.\n\nThe agent takes a screenshot of the page, extracts the interactive elements, and prepares a set-of-mark screenshot with bounding boxes around the interactive elements.\n\nIf the model returns a string, the agent returns the string as the final response.\n\nIf the model returns a list of tool calls, the agent executes the tool calls with _execute_tool() using _playwright_controller.\n\nThe agent returns a final response which includes a screenshot of the page, page metadata, description of the action taken and the inner text of the webpage.\n\nIf at any point the agent encounters an error, it returns the error message as the final response.\n\nPlease note that using the MultimodalWebSurfer involves interacting with a digital world designed for humans, which carries inherent risks. Be aware that agents may occasionally attempt risky actions, such as recruiting humans for help or accepting cookie agreements without human involvement. Always ensure agents are monitored and operate within a controlled environment to prevent unintended consequences. Moreover, be cautious that MultimodalWebSurfer may be susceptible to prompt injection attacks from webpages.\n\nOn Windows, the event loop policy must be set to WindowsProactorEventLoopPolicy to avoid issues with subprocesses.\n\nname (str) – The name of the agent.\n\nmodel_client (ChatCompletionClient) – The model client used by the agent. Must be multimodal and support function calling.\n\ndownloads_folder (str, optional) – The folder where downloads are saved. Defaults to None, no downloads are saved.\n\ndescription (str, optional) – The description of the agent. Defaults to MultimodalWebSurfer.DEFAULT_DESCRIPTION.\n\ndebug_dir (str, optional) – The directory where debug information is saved. Defaults to None.\n\nheadless (bool, optional) – Whether the browser should be headless. Defaults to True.\n\nstart_page (str, optional) – The start page for the browser. Defaults to MultimodalWebSurfer.DEFAULT_START_PAGE.\n\nanimate_actions (bool, optional) – Whether to animate actions. Defaults to False.\n\nto_save_screenshots (bool, optional) – Whether to save screenshots. Defaults to False.\n\nuse_ocr (bool, optional) – Whether to use OCR. Defaults to False.\n\nbrowser_channel (str, optional) – The browser channel. Defaults to None.\n\nbrowser_data_dir (str, optional) – The browser data directory. Defaults to None.\n\nto_resize_viewport (bool, optional) – Whether to resize the viewport. Defaults to True.\n\nplaywright (Playwright, optional) – The playwright instance. Defaults to None.\n\ncontext (BrowserContext, optional) – The browser context. Defaults to None.\n\nThe following example demonstrates how to create a web surfing agent with a model client and run it for multiple turns.\n\nThe logical type of the component.\n\nalias of MultimodalWebSurferConfig\n\nOverride the provider string for the component. This should be used to prevent internal module names being a part of the module name.\n\nClose the browser and the page. Should be called when the agent is no longer needed.\n\nThe types of messages that the agent produces in the Response.chat_message field. They must be BaseChatMessage types.\n\nResets the agent to its initialization state.\n\nHandles incoming messages and returns a response.\n\nAgents are stateful and the messages passed to this method should be the new messages since the last call to this method. The agent should maintain its state between calls to this method. For example, if the agent needs to remember the previous messages to respond to the current message, it should store the previous messages in the agent state.\n\nHandles incoming messages and returns a stream of messages and and the final item is the response. The base implementation in BaseChatAgent simply calls on_messages() and yields the messages in the response.\n\nAgents are stateful and the messages passed to this method should be the new messages since the last call to this method. The agent should maintain its state between calls to this method. For example, if the agent needs to remember the previous messages to respond to the current message, it should store the previous messages in the agent state.\n\nDump the configuration that would be requite to create a new instance of a component matching the configuration of this instance.\n\nT – The configuration of the component.\n\nCreate a new instance of the component from a configuration object.\n\nconfig (T) – The configuration object.\n\nSelf – The new instance of the component.\n\nA helper class to allow Playwright to interact with web pages to perform actions such as clicking, filling, and scrolling.\n\ndownloads_folder (str | None) – The folder to save downloads to. If None, downloads are not saved.\n\nanimate_actions (bool) – Whether to animate the actions (create fake cursor to click).\n\nviewport_width (int) – The width of the viewport.\n\nviewport_height (int) – The height of the viewport.\n\n_download_handler (Optional[Callable[[Download], None]]) – A function to handle downloads.\n\nto_resize_viewport (bool) – Whether to resize the viewport\n\nPause the execution for a specified duration.\n\npage (Page) – The Playwright page object.\n\nduration (Union[int, float]) – The duration to sleep in milliseconds.\n\nRetrieve interactive regions from the web page.\n\npage (Page) – The Playwright page object.\n\nDict[str, InteractiveRegion] – A dictionary of interactive regions.\n\nRetrieve the visual viewport of the web page.\n\npage (Page) – The Playwright page object.\n\nVisualViewport – The visual viewport of the page.\n\nRetrieve the ID of the currently focused element.\n\npage (Page) – The Playwright page object.\n\nstr – The ID of the focused element or None if no control has focus.\n\nRetrieve metadata from the web page.\n\npage (Page) – The Playwright page object.\n\nDict[str, Any] – A dictionary of page metadata.\n\nHandle actions to perform on a new page.\n\npage (Page) – The Playwright page object.\n\nNavigate back to the previous page.\n\npage (Page) – The Playwright page object.\n\nVisit a specified URL.\n\npage (Page) – The Playwright page object.\n\nurl (str) – The URL to visit.\n\nTuple[bool, bool] – A tuple indicating whether to reset prior metadata hash and last download.\n\nScroll the page down by one viewport height minus 50 pixels.\n\npage (Page) – The Playwright page object.\n\nScroll the page up by one viewport height minus 50 pixels.\n\npage (Page) – The Playwright page object.\n\nAnimate the cursor movement gradually from start to end coordinates.\n\npage (Page) – The Playwright page object.\n\nstart_x (float) – The starting x-coordinate.\n\nstart_y (float) – The starting y-coordinate.\n\nend_x (float) – The ending x-coordinate.\n\nend_y (float) – The ending y-coordinate.\n\nAdd a red cursor box around the element with the given identifier.\n\npage (Page) – The Playwright page object.\n\nidentifier (str) – The element identifier.\n\nRemove the red cursor box around the element with the given identifier.\n\npage (Page) – The Playwright page object.\n\nidentifier (str) – The element identifier.\n\nClick the element with the given identifier.\n\npage (Page) – The Playwright page object.\n\nidentifier (str) – The element identifier.\n\nPage | None – The new page if a new page is opened, otherwise None.\n\nHover the mouse over the element with the given identifier.\n\npage (Page) – The Playwright page object.\n\nidentifier (str) – The element identifier.\n\nFill the element with the given identifier with the specified value.\n\npage (Page) – The Playwright page object.\n\nidentifier (str) – The element identifier.\n\nvalue (str) – The value to fill.\n\nScroll the element with the given identifier in the specified direction.\n\npage (Page) – The Playwright page object.\n\nidentifier (str) – The element identifier.\n\ndirection (str) – The direction to scroll (“up” or “down”).\n\nRetrieve the text content of the web page.\n\npage (Page) – The Playwright page object.\n\nn_lines (int) – The number of lines to return from the page inner text.\n\nstr – The text content of the page.\n\nRetrieve the text content of the browser viewport (approximately).\n\npage (Page) – The Playwright page object.\n\nstr – The text content of the page.\n\nRetrieve the markdown content of the web page. Currently not implemented.\n\npage (Page) – The Playwright page object.\n\nstr – The markdown content of the page.\n\nautogen_ext.agents.video_surfer\n\nautogen_ext.auth.azure",
  "headings": [
    {
      "level": "h1",
      "text": "autogen_ext.agents.web_surfer#",
      "id": ""
    }
  ],
  "code_samples": [
    {
      "code": "pip install \"autogen-ext[web-surfer]\"",
      "language": "unknown"
    },
    {
      "code": "pip install \"autogen-ext[web-surfer]\"",
      "language": "unknown"
    },
    {
      "code": "import sys\nimport asyncio\n\nif sys.platform == \"win32\":\n    asyncio.set_event_loop_policy(asyncio.WindowsProactorEventLoopPolicy())",
      "language": "python"
    },
    {
      "code": "import sys\nimport asyncio\n\nif sys.platform == \"win32\":\n    asyncio.set_event_loop_policy(asyncio.WindowsProactorEventLoopPolicy())",
      "language": "python"
    },
    {
      "code": "import asyncio\nfrom autogen_agentchat.ui import Console\nfrom autogen_agentchat.teams import RoundRobinGroupChat\nfrom autogen_ext.models.openai import OpenAIChatCompletionClient\nfrom autogen_ext.agents.web_surfer import MultimodalWebSurfer\n\n\nasync def main() -> None:\n    # Define an agent\n    web_surfer_agent = MultimodalWebSurfer(\n        name=\"MultimodalWebSurfer\",\n        model_client=OpenAIChatCompletionClient(model=\"gpt-4o-2024-08-06\"),\n    )\n\n    # Define a team\n    agent_team = RoundRobinGroupChat([web_surfer_agent], max_turns=3)\n\n    # Run the team and stream messages to the console\n    stream = agent_team.run_stream(task=\"Navigate to the AutoGen readme on GitHub.\")\n    await Console(stream)\n    # Close the browser controlled by the agent\n    await web_surfer_agent.close()\n\n\nasyncio.run(main())",
      "language": "python"
    },
    {
      "code": "import asyncio\nfrom autogen_agentchat.ui import Console\nfrom autogen_agentchat.teams import RoundRobinGroupChat\nfrom autogen_ext.models.openai import OpenAIChatCompletionClient\nfrom autogen_ext.agents.web_surfer import MultimodalWebSurfer\n\n\nasync def main() -> None:\n    # Define an agent\n    web_surfer_agent = MultimodalWebSurfer(\n        name=\"MultimodalWebSurfer\",\n        model_client=OpenAIChatCompletionClient(model=\"gpt-4o-2024-08-06\"),\n    )\n\n    # Define a team\n    agent_team = RoundRobinGroupChat([web_surfer_agent], max_turns=3)\n\n    # Run the team and stream messages to the console\n    stream = agent_team.run_stream(task=\"Navigate to the AutoGen readme on GitHub.\")\n    await Console(stream)\n    # Close the browser controlled by the agent\n    await web_surfer_agent.close()\n\n\nasyncio.run(main())",
      "language": "python"
    }
  ],
  "patterns": [
    {
      "description": "API Reference autogen_ext.agents.web_surfer autogen_ext.agents.web_surfer# class MultimodalWebSurfer(name: str, model_client: ChatCompletionClient, downloads_folder: str | None = None, description: str = DEFAULT_DESCRIPTION, debug_dir: str | None = None, headless: bool = True, start_page: str | None = DEFAULT_START_PAGE, animate_actions: bool = False, to_save_screenshots: bool = False, use_ocr: bool = False, browser_channel: str | None = None, browser_data_dir: str | None = None, to_resize_viewport: bool = True, playwright: Playwright | None = None, context: BrowserContext | None = None)[source]# Bases: BaseChatAgent, Component[MultimodalWebSurferConfig] MultimodalWebSurfer is a multimodal agent that acts as a web surfer that can search the web and visit web pages. Installation: pip install \"autogen-ext[web-surfer]\" It launches a chromium browser and allows the playwright to interact with the web browser and can perform a variety of actions. The browser is launched on the first call to the agent and is reused for subsequent calls. It must be used with a multimodal model client that supports function/tool calling, ideally GPT-4o currently. When on_messages() or on_messages_stream() is called, the following occurs: If this is the first call, the browser is initialized and the page is loaded. This is done in _lazy_init(). The browser is only closed when close() is called. The method _generate_reply() is called, which then creates the final response as below. The agent takes a screenshot of the page, extracts the interactive elements, and prepares a set-of-mark screenshot with bounding boxes around the interactive elements. The agent makes a call to the model_client with the SOM screenshot, history of messages, and the list of available tools. If the model returns a string, the agent returns the string as the final response. If the model returns a list of tool calls, the agent executes the tool calls with _execute_tool() using _playwright_controller. The agent returns a final response which includes a screenshot of the page, page metadata, description of the action taken and the inner text of the webpage. If at any point the agent encounters an error, it returns the error message as the final response. Note Please note that using the MultimodalWebSurfer involves interacting with a digital world designed for humans, which carries inherent risks. Be aware that agents may occasionally attempt risky actions, such as recruiting humans for help or accepting cookie agreements without human involvement. Always ensure agents are monitored and operate within a controlled environment to prevent unintended consequences. Moreover, be cautious that MultimodalWebSurfer may be susceptible to prompt injection attacks from webpages. Note On Windows, the event loop policy must be set to WindowsProactorEventLoopPolicy to avoid issues with subprocesses. import sys import asyncio if sys.platform == \"win32\": asyncio.set_event_loop_policy(asyncio.WindowsProactorEventLoopPolicy()) Parameters: name (str) – The name of the agent. model_client (ChatCompletionClient) – The model client used by the agent. Must be multimodal and support function calling. downloads_folder (str, optional) – The folder where downloads are saved. Defaults to None, no downloads are saved. description (str, optional) – The description of the agent. Defaults to MultimodalWebSurfer.DEFAULT_DESCRIPTION. debug_dir (str, optional) – The directory where debug information is saved. Defaults to None. headless (bool, optional) – Whether the browser should be headless. Defaults to True. start_page (str, optional) – The start page for the browser. Defaults to MultimodalWebSurfer.DEFAULT_START_PAGE. animate_actions (bool, optional) – Whether to animate actions. Defaults to False. to_save_screenshots (bool, optional) – Whether to save screenshots. Defaults to False. use_ocr (bool, optional) – Whether to use OCR. Defaults to False. browser_channel (str, optional) – The browser channel. Defaults to None. browser_data_dir (str, optional) – The browser data directory. Defaults to None. to_resize_viewport (bool, optional) – Whether to resize the viewport. Defaults to True. playwright (Playwright, optional) – The playwright instance. Defaults to None. context (BrowserContext, optional) – The browser context. Defaults to None. Example usage: The following example demonstrates how to create a web surfing agent with a model client and run it for multiple turns. import asyncio from autogen_agentchat.ui import Console from autogen_agentchat.teams import RoundRobinGroupChat from autogen_ext.models.openai import OpenAIChatCompletionClient from autogen_ext.agents.web_surfer import MultimodalWebSurfer async def main() -> None: # Define an agent web_surfer_agent = MultimodalWebSurfer( name=\"MultimodalWebSurfer\", model_client=OpenAIChatCompletionClient(model=\"gpt-4o-2024-08-06\"), ) # Define a team agent_team = RoundRobinGroupChat([web_surfer_agent], max_turns=3) # Run the team and stream messages to the console stream = agent_team.run_stream(task=\"Navigate to the AutoGen readme on GitHub.\") await Console(stream) # Close the browser controlled by the agent await web_surfer_agent.close() asyncio.run(main()) component_type: ClassVar[ComponentType] = 'agent'# The logical type of the component. component_config_schema# alias of MultimodalWebSurferConfig component_provider_override: ClassVar[str | None] = 'autogen_ext.agents.web_surfer.MultimodalWebSurfer'# Override the provider string for the component. This should be used to prevent internal module names being a part of the module name. DEFAULT_DESCRIPTION = '\\n A helpful assistant with access to a web browser.\\n Ask them to perform web searches, open pages, and interact with content (e.g., clicking links, scrolling the viewport, filling in form fields, etc.).\\n It can also summarize the entire page, or answer questions based on the content of the page.\\n It can also be asked to sleep and wait for pages to load, in cases where the page seems not yet fully loaded.\\n '# DEFAULT_START_PAGE = 'https://www.bing.com/'# VIEWPORT_HEIGHT = 900# VIEWPORT_WIDTH = 1440# MLM_HEIGHT = 765# MLM_WIDTH = 1224# SCREENSHOT_TOKENS = 1105# async close() → None[source]# Close the browser and the page. Should be called when the agent is no longer needed. property produced_message_types: Sequence[type[BaseChatMessage]]# The types of messages that the agent produces in the Response.chat_message field. They must be BaseChatMessage types. async on_reset(cancellation_token: CancellationToken) → None[source]# Resets the agent to its initialization state. async on_messages(messages: Sequence[BaseChatMessage], cancellation_token: CancellationToken) → Response[source]# Handles incoming messages and returns a response. Note Agents are stateful and the messages passed to this method should be the new messages since the last call to this method. The agent should maintain its state between calls to this method. For example, if the agent needs to remember the previous messages to respond to the current message, it should store the previous messages in the agent state. async on_messages_stream(messages: Sequence[BaseChatMessage], cancellation_token: CancellationToken) → AsyncGenerator[BaseAgentEvent | BaseChatMessage | Response, None][source]# Handles incoming messages and returns a stream of messages and and the final item is the response. The base implementation in BaseChatAgent simply calls on_messages() and yields the messages in the response. Note Agents are stateful and the messages passed to this method should be the new messages since the last call to this method. The agent should maintain its state between calls to this method. For example, if the agent needs to remember the previous messages to respond to the current message, it should store the previous messages in the agent state. _to_config() → MultimodalWebSurferConfig[source]# Dump the configuration that would be requite to create a new instance of a component matching the configuration of this instance. Returns: T – The configuration of the component. classmethod _from_config(config: MultimodalWebSurferConfig) → Self[source]# Create a new instance of the component from a configuration object. Parameters: config (T) – The configuration object. Returns: Self – The new instance of the component. class PlaywrightController(downloads_folder: str | None = None, animate_actions: bool = False, viewport_width: int = 1440, viewport_height: int = 900, _download_handler: Callable[[Download], None] | None = None, to_resize_viewport: bool = True)[source]# Bases: object A helper class to allow Playwright to interact with web pages to perform actions such as clicking, filling, and scrolling. Parameters: downloads_folder (str | None) – The folder to save downloads to. If None, downloads are not saved. animate_actions (bool) – Whether to animate the actions (create fake cursor to click). viewport_width (int) – The width of the viewport. viewport_height (int) – The height of the viewport. _download_handler (Optional[Callable[[Download], None]]) – A function to handle downloads. to_resize_viewport (bool) – Whether to resize the viewport async sleep(page: Page, duration: int | float) → None[source]# Pause the execution for a specified duration. Parameters: page (Page) – The Playwright page object. duration (Union[int, float]) – The duration to sleep in milliseconds. async get_interactive_rects(page: Page) → Dict[str, InteractiveRegion][source]# Retrieve interactive regions from the web page. Parameters: page (Page) – The Playwright page object. Returns: Dict[str, InteractiveRegion] – A dictionary of interactive regions. async get_visual_viewport(page: Page) → VisualViewport[source]# Retrieve the visual viewport of the web page. Parameters: page (Page) – The Playwright page object. Returns: VisualViewport – The visual viewport of the page. async get_focused_rect_id(page: Page) → str | None[source]# Retrieve the ID of the currently focused element. Parameters: page (Page) – The Playwright page object. Returns: str – The ID of the focused element or None if no control has focus. async get_page_metadata(page: Page) → Dict[str, Any][source]# Retrieve metadata from the web page. Parameters: page (Page) – The Playwright page object. Returns: Dict[str, Any] – A dictionary of page metadata. async on_new_page(page: Page) → None[source]# Handle actions to perform on a new page. Parameters: page (Page) – The Playwright page object. async back(page: Page) → None[source]# Navigate back to the previous page. Parameters: page (Page) – The Playwright page object. async visit_page(page: Page, url: str) → Tuple[bool, bool][source]# Visit a specified URL. Parameters: page (Page) – The Playwright page object. url (str) – The URL to visit. Returns: Tuple[bool, bool] – A tuple indicating whether to reset prior metadata hash and last download. async page_down(page: Page) → None[source]# Scroll the page down by one viewport height minus 50 pixels. Parameters: page (Page) – The Playwright page object. async page_up(page: Page) → None[source]# Scroll the page up by one viewport height minus 50 pixels. Parameters: page (Page) – The Playwright page object. async gradual_cursor_animation(page: Page, start_x: float, start_y: float, end_x: float, end_y: float) → None[source]# Animate the cursor movement gradually from start to end coordinates. Parameters: page (Page) – The Playwright page object. start_x (float) – The starting x-coordinate. start_y (float) – The starting y-coordinate. end_x (float) – The ending x-coordinate. end_y (float) – The ending y-coordinate. async add_cursor_box(page: Page, identifier: str) → None[source]# Add a red cursor box around the element with the given identifier. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. async remove_cursor_box(page: Page, identifier: str) → None[source]# Remove the red cursor box around the element with the given identifier. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. async click_id(page: Page, identifier: str) → Page | None[source]# Click the element with the given identifier. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. Returns: Page | None – The new page if a new page is opened, otherwise None. async hover_id(page: Page, identifier: str) → None[source]# Hover the mouse over the element with the given identifier. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. async fill_id(page: Page, identifier: str, value: str, press_enter: bool = True) → None[source]# Fill the element with the given identifier with the specified value. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. value (str) – The value to fill. async scroll_id(page: Page, identifier: str, direction: str) → None[source]# Scroll the element with the given identifier in the specified direction. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. direction (str) – The direction to scroll (“up” or “down”). async get_webpage_text(page: Page, n_lines: int = 50) → str[source]# Retrieve the text content of the web page. Parameters: page (Page) – The Playwright page object. n_lines (int) – The number of lines to return from the page inner text. Returns: str – The text content of the page. async get_visible_text(page: Page) → str[source]# Retrieve the text content of the browser viewport (approximately). Parameters: page (Page) – The Playwright page object. Returns: str – The text content of the page. async get_page_markdown(page: Page) → str[source]# Retrieve the markdown content of the web page. Currently not implemented. Parameters: page (Page) – The Playwright page object. Returns: str – The markdown content of the page. previous autogen_ext.agents.video_surfer next autogen_ext.auth.azure On this page MultimodalWebSurfer MultimodalWebSurfer.component_type MultimodalWebSurfer.component_config_schema MultimodalWebSurfer.component_provider_override MultimodalWebSurfer.DEFAULT_DESCRIPTION MultimodalWebSurfer.DEFAULT_START_PAGE MultimodalWebSurfer.VIEWPORT_HEIGHT MultimodalWebSurfer.VIEWPORT_WIDTH MultimodalWebSurfer.MLM_HEIGHT MultimodalWebSurfer.MLM_WIDTH MultimodalWebSurfer.SCREENSHOT_TOKENS MultimodalWebSurfer.close() MultimodalWebSurfer.produced_message_types MultimodalWebSurfer.on_reset() MultimodalWebSurfer.on_messages() MultimodalWebSurfer.on_messages_stream() MultimodalWebSurfer._to_config() MultimodalWebSurfer._from_config() PlaywrightController PlaywrightController.sleep() PlaywrightController.get_interactive_rects() PlaywrightController.get_visual_viewport() PlaywrightController.get_focused_rect_id() PlaywrightController.get_page_metadata() PlaywrightController.on_new_page() PlaywrightController.back() PlaywrightController.visit_page() PlaywrightController.page_down() PlaywrightController.page_up() PlaywrightController.gradual_cursor_animation() PlaywrightController.add_cursor_box() PlaywrightController.remove_cursor_box() PlaywrightController.click_id() PlaywrightController.hover_id() PlaywrightController.fill_id() PlaywrightController.scroll_id() PlaywrightController.get_webpage_text() PlaywrightController.get_visible_text() PlaywrightController.get_page_markdown() Edit on GitHub Show Source",
      "code": "BaseChatAgent"
    },
    {
      "description": "API Reference autogen_ext.agents.web_surfer autogen_ext.agents.web_surfer# class MultimodalWebSurfer(name: str, model_client: ChatCompletionClient, downloads_folder: str | None = None, description: str = DEFAULT_DESCRIPTION, debug_dir: str | None = None, headless: bool = True, start_page: str | None = DEFAULT_START_PAGE, animate_actions: bool = False, to_save_screenshots: bool = False, use_ocr: bool = False, browser_channel: str | None = None, browser_data_dir: str | None = None, to_resize_viewport: bool = True, playwright: Playwright | None = None, context: BrowserContext | None = None)[source]# Bases: BaseChatAgent, Component[MultimodalWebSurferConfig] MultimodalWebSurfer is a multimodal agent that acts as a web surfer that can search the web and visit web pages. Installation: pip install \"autogen-ext[web-surfer]\" It launches a chromium browser and allows the playwright to interact with the web browser and can perform a variety of actions. The browser is launched on the first call to the agent and is reused for subsequent calls. It must be used with a multimodal model client that supports function/tool calling, ideally GPT-4o currently. When on_messages() or on_messages_stream() is called, the following occurs: If this is the first call, the browser is initialized and the page is loaded. This is done in _lazy_init(). The browser is only closed when close() is called. The method _generate_reply() is called, which then creates the final response as below. The agent takes a screenshot of the page, extracts the interactive elements, and prepares a set-of-mark screenshot with bounding boxes around the interactive elements. The agent makes a call to the model_client with the SOM screenshot, history of messages, and the list of available tools. If the model returns a string, the agent returns the string as the final response. If the model returns a list of tool calls, the agent executes the tool calls with _execute_tool() using _playwright_controller. The agent returns a final response which includes a screenshot of the page, page metadata, description of the action taken and the inner text of the webpage. If at any point the agent encounters an error, it returns the error message as the final response. Note Please note that using the MultimodalWebSurfer involves interacting with a digital world designed for humans, which carries inherent risks. Be aware that agents may occasionally attempt risky actions, such as recruiting humans for help or accepting cookie agreements without human involvement. Always ensure agents are monitored and operate within a controlled environment to prevent unintended consequences. Moreover, be cautious that MultimodalWebSurfer may be susceptible to prompt injection attacks from webpages. Note On Windows, the event loop policy must be set to WindowsProactorEventLoopPolicy to avoid issues with subprocesses. import sys import asyncio if sys.platform == \"win32\": asyncio.set_event_loop_policy(asyncio.WindowsProactorEventLoopPolicy()) Parameters: name (str) – The name of the agent. model_client (ChatCompletionClient) – The model client used by the agent. Must be multimodal and support function calling. downloads_folder (str, optional) – The folder where downloads are saved. Defaults to None, no downloads are saved. description (str, optional) – The description of the agent. Defaults to MultimodalWebSurfer.DEFAULT_DESCRIPTION. debug_dir (str, optional) – The directory where debug information is saved. Defaults to None. headless (bool, optional) – Whether the browser should be headless. Defaults to True. start_page (str, optional) – The start page for the browser. Defaults to MultimodalWebSurfer.DEFAULT_START_PAGE. animate_actions (bool, optional) – Whether to animate actions. Defaults to False. to_save_screenshots (bool, optional) – Whether to save screenshots. Defaults to False. use_ocr (bool, optional) – Whether to use OCR. Defaults to False. browser_channel (str, optional) – The browser channel. Defaults to None. browser_data_dir (str, optional) – The browser data directory. Defaults to None. to_resize_viewport (bool, optional) – Whether to resize the viewport. Defaults to True. playwright (Playwright, optional) – The playwright instance. Defaults to None. context (BrowserContext, optional) – The browser context. Defaults to None. Example usage: The following example demonstrates how to create a web surfing agent with a model client and run it for multiple turns. import asyncio from autogen_agentchat.ui import Console from autogen_agentchat.teams import RoundRobinGroupChat from autogen_ext.models.openai import OpenAIChatCompletionClient from autogen_ext.agents.web_surfer import MultimodalWebSurfer async def main() -> None: # Define an agent web_surfer_agent = MultimodalWebSurfer( name=\"MultimodalWebSurfer\", model_client=OpenAIChatCompletionClient(model=\"gpt-4o-2024-08-06\"), ) # Define a team agent_team = RoundRobinGroupChat([web_surfer_agent], max_turns=3) # Run the team and stream messages to the console stream = agent_team.run_stream(task=\"Navigate to the AutoGen readme on GitHub.\") await Console(stream) # Close the browser controlled by the agent await web_surfer_agent.close() asyncio.run(main()) component_type: ClassVar[ComponentType] = 'agent'# The logical type of the component. component_config_schema# alias of MultimodalWebSurferConfig component_provider_override: ClassVar[str | None] = 'autogen_ext.agents.web_surfer.MultimodalWebSurfer'# Override the provider string for the component. This should be used to prevent internal module names being a part of the module name. DEFAULT_DESCRIPTION = '\\n A helpful assistant with access to a web browser.\\n Ask them to perform web searches, open pages, and interact with content (e.g., clicking links, scrolling the viewport, filling in form fields, etc.).\\n It can also summarize the entire page, or answer questions based on the content of the page.\\n It can also be asked to sleep and wait for pages to load, in cases where the page seems not yet fully loaded.\\n '# DEFAULT_START_PAGE = 'https://www.bing.com/'# VIEWPORT_HEIGHT = 900# VIEWPORT_WIDTH = 1440# MLM_HEIGHT = 765# MLM_WIDTH = 1224# SCREENSHOT_TOKENS = 1105# async close() → None[source]# Close the browser and the page. Should be called when the agent is no longer needed. property produced_message_types: Sequence[type[BaseChatMessage]]# The types of messages that the agent produces in the Response.chat_message field. They must be BaseChatMessage types. async on_reset(cancellation_token: CancellationToken) → None[source]# Resets the agent to its initialization state. async on_messages(messages: Sequence[BaseChatMessage], cancellation_token: CancellationToken) → Response[source]# Handles incoming messages and returns a response. Note Agents are stateful and the messages passed to this method should be the new messages since the last call to this method. The agent should maintain its state between calls to this method. For example, if the agent needs to remember the previous messages to respond to the current message, it should store the previous messages in the agent state. async on_messages_stream(messages: Sequence[BaseChatMessage], cancellation_token: CancellationToken) → AsyncGenerator[BaseAgentEvent | BaseChatMessage | Response, None][source]# Handles incoming messages and returns a stream of messages and and the final item is the response. The base implementation in BaseChatAgent simply calls on_messages() and yields the messages in the response. Note Agents are stateful and the messages passed to this method should be the new messages since the last call to this method. The agent should maintain its state between calls to this method. For example, if the agent needs to remember the previous messages to respond to the current message, it should store the previous messages in the agent state. _to_config() → MultimodalWebSurferConfig[source]# Dump the configuration that would be requite to create a new instance of a component matching the configuration of this instance. Returns: T – The configuration of the component. classmethod _from_config(config: MultimodalWebSurferConfig) → Self[source]# Create a new instance of the component from a configuration object. Parameters: config (T) – The configuration object. Returns: Self – The new instance of the component. class PlaywrightController(downloads_folder: str | None = None, animate_actions: bool = False, viewport_width: int = 1440, viewport_height: int = 900, _download_handler: Callable[[Download], None] | None = None, to_resize_viewport: bool = True)[source]# Bases: object A helper class to allow Playwright to interact with web pages to perform actions such as clicking, filling, and scrolling. Parameters: downloads_folder (str | None) – The folder to save downloads to. If None, downloads are not saved. animate_actions (bool) – Whether to animate the actions (create fake cursor to click). viewport_width (int) – The width of the viewport. viewport_height (int) – The height of the viewport. _download_handler (Optional[Callable[[Download], None]]) – A function to handle downloads. to_resize_viewport (bool) – Whether to resize the viewport async sleep(page: Page, duration: int | float) → None[source]# Pause the execution for a specified duration. Parameters: page (Page) – The Playwright page object. duration (Union[int, float]) – The duration to sleep in milliseconds. async get_interactive_rects(page: Page) → Dict[str, InteractiveRegion][source]# Retrieve interactive regions from the web page. Parameters: page (Page) – The Playwright page object. Returns: Dict[str, InteractiveRegion] – A dictionary of interactive regions. async get_visual_viewport(page: Page) → VisualViewport[source]# Retrieve the visual viewport of the web page. Parameters: page (Page) – The Playwright page object. Returns: VisualViewport – The visual viewport of the page. async get_focused_rect_id(page: Page) → str | None[source]# Retrieve the ID of the currently focused element. Parameters: page (Page) – The Playwright page object. Returns: str – The ID of the focused element or None if no control has focus. async get_page_metadata(page: Page) → Dict[str, Any][source]# Retrieve metadata from the web page. Parameters: page (Page) – The Playwright page object. Returns: Dict[str, Any] – A dictionary of page metadata. async on_new_page(page: Page) → None[source]# Handle actions to perform on a new page. Parameters: page (Page) – The Playwright page object. async back(page: Page) → None[source]# Navigate back to the previous page. Parameters: page (Page) – The Playwright page object. async visit_page(page: Page, url: str) → Tuple[bool, bool][source]# Visit a specified URL. Parameters: page (Page) – The Playwright page object. url (str) – The URL to visit. Returns: Tuple[bool, bool] – A tuple indicating whether to reset prior metadata hash and last download. async page_down(page: Page) → None[source]# Scroll the page down by one viewport height minus 50 pixels. Parameters: page (Page) – The Playwright page object. async page_up(page: Page) → None[source]# Scroll the page up by one viewport height minus 50 pixels. Parameters: page (Page) – The Playwright page object. async gradual_cursor_animation(page: Page, start_x: float, start_y: float, end_x: float, end_y: float) → None[source]# Animate the cursor movement gradually from start to end coordinates. Parameters: page (Page) – The Playwright page object. start_x (float) – The starting x-coordinate. start_y (float) – The starting y-coordinate. end_x (float) – The ending x-coordinate. end_y (float) – The ending y-coordinate. async add_cursor_box(page: Page, identifier: str) → None[source]# Add a red cursor box around the element with the given identifier. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. async remove_cursor_box(page: Page, identifier: str) → None[source]# Remove the red cursor box around the element with the given identifier. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. async click_id(page: Page, identifier: str) → Page | None[source]# Click the element with the given identifier. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. Returns: Page | None – The new page if a new page is opened, otherwise None. async hover_id(page: Page, identifier: str) → None[source]# Hover the mouse over the element with the given identifier. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. async fill_id(page: Page, identifier: str, value: str, press_enter: bool = True) → None[source]# Fill the element with the given identifier with the specified value. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. value (str) – The value to fill. async scroll_id(page: Page, identifier: str, direction: str) → None[source]# Scroll the element with the given identifier in the specified direction. Parameters: page (Page) – The Playwright page object. identifier (str) – The element identifier. direction (str) – The direction to scroll (“up” or “down”). async get_webpage_text(page: Page, n_lines: int = 50) → str[source]# Retrieve the text content of the web page. Parameters: page (Page) – The Playwright page object. n_lines (int) – The number of lines to return from the page inner text. Returns: str – The text content of the page. async get_visible_text(page: Page) → str[source]# Retrieve the text content of the browser viewport (approximately). Parameters: page (Page) – The Playwright page object. Returns: str – The text content of the page. async get_page_markdown(page: Page) → str[source]# Retrieve the markdown content of the web page. Currently not implemented. Parameters: page (Page) – The Playwright page object. Returns: str – The markdown content of the page. previous autogen_ext.agents.video_surfer next autogen_ext.auth.azure",
      "code": "BaseChatAgent"
    },
    {
      "description": "Example usage:",
      "code": "import asyncio\nfrom autogen_agentchat.ui import Console\nfrom autogen_agentchat.teams import RoundRobinGroupChat\nfrom autogen_ext.models.openai import OpenAIChatCompletionClient\nfrom autogen_ext.agents.web_surfer import MultimodalWebSurfer\n\n\nasync def main() -> None:\n    # Define an agent\n    web_surfer_agent = MultimodalWebSurfer(\n        name=\"MultimodalWebSurfer\",\n        model_client=OpenAIChatCompletionClient(model=\"gpt-4o-2024-08-06\"),\n    )\n\n    # Define a team\n    agent_team = RoundRobinGroupChat([web_surfer_agent], max_turns=3)\n\n    # Run the team and stream messages to the console\n    stream = agent_team.run_stream(task=\"Navigate to the AutoGen readme on GitHub.\")\n    await Console(stream)\n    # Close the browser controlled by the agent\n    await web_surfer_agent.close()\n\n\nasyncio.run(main())"
    }
  ],
  "links": [
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.web_surfer.html",
    "https://microsoft.github.io/autogen/stable/index.html",
    "https://microsoft.github.io/autogen/stable/user-guide/agentchat-user-guide/index.html",
    "https://microsoft.github.io/autogen/stable/user-guide/core-user-guide/index.html",
    "https://microsoft.github.io/autogen/stable/user-guide/extensions-user-guide/index.html",
    "https://microsoft.github.io/autogen/stable/user-guide/autogenstudio-user-guide/index.html",
    "https://microsoft.github.io/autogen/stable/reference/index.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.agents.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.base.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.conditions.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.messages.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.state.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.teams.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.tools.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.ui.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.utils.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.code_executor.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.exceptions.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.logging.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.memory.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.model_context.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.models.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.tool_agent.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.tools.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.utils.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.cache_store.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.experimental.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.teams.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.ui.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.file_surfer.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.magentic_one.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.openai.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.video_surfer.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.auth.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.cache_store.diskcache.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.cache_store.redis.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.docker.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.docker_jupyter.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.jupyter.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.local.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.experimental.task_centric_memory.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.canvas.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.chromadb.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.mem0.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.redis.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.anthropic.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.cache.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.llama_cpp.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.ollama.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.openai.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.replay.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.semantic_kernel.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.teams.magentic_one.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.code_execution.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.graphrag.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.http.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.langchain.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.mcp.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.semantic_kernel.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.video_surfer.tools.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.web_surfer.playwright_controller.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.experimental.task_centric_memory.utils.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.anthropic.config.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.azure.config.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.ollama.config.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.openai.config.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.agent_worker_pb2.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.agent_worker_pb2_grpc.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.cloudevent_pb2.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.cloudevent_pb2_grpc.html"
  ]
}