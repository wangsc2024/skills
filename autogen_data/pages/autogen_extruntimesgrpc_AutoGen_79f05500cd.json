{
  "url": "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.html",
  "title": "autogen_ext.runtimes.grpc — AutoGen",
  "content": "An agent runtime for running remote or cross-language agents.\n\nAgent messaging uses protobufs from agent_worker.proto and CloudEvent from cloudevent.proto.\n\nCross-language agents will additionally require all agents use shared protobuf schemas for any message types that are sent between agents.\n\nStart the runtime in a background task.\n\nStop the runtime immediately.\n\nStop the runtime when a signal is received.\n\nSend a message to an agent and get a response.\n\nmessage (Any) – The message to send.\n\nrecipient (AgentId) – The agent to send the message to.\n\nsender (AgentId | None, optional) – Agent which sent the message. Should only be None if this was sent from no agent, such as directly to the runtime externally. Defaults to None.\n\ncancellation_token (CancellationToken | None, optional) – Token used to cancel an in progress . Defaults to None.\n\nCantHandleException – If the recipient cannot handle the message.\n\nUndeliverableException – If the message cannot be delivered.\n\nOther – Any other exception raised by the recipient.\n\nAny – The response from the agent.\n\nPublish a message to all agents in the given namespace, or if no namespace is provided, the namespace of the sender.\n\nNo responses are expected from publishing.\n\nmessage (Any) – The message to publish.\n\ntopic_id (TopicId) – The topic to publish the message to.\n\nsender (AgentId | None, optional) – The agent which sent the message. Defaults to None.\n\ncancellation_token (CancellationToken | None, optional) – Token used to cancel an in progress. Defaults to None.\n\nmessage_id (str | None, optional) – The message id. If None, a new message id will be generated. Defaults to None. This message id must be unique. and is recommended to be a UUID.\n\nUndeliverableException – If the message cannot be delivered.\n\nSave the state of the entire runtime, including all hosted agents. The only way to restore the state is to pass it to load_state().\n\nThe structure of the state is implementation defined and can be any JSON serializable object.\n\nMapping[str, Any] – The saved state.\n\nLoad the state of the entire runtime, including all hosted agents. The state should be the same as the one returned by save_state().\n\nstate (Mapping[str, Any]) – The saved state.\n\nGet the metadata for an agent.\n\nagent (AgentId) – The agent id.\n\nAgentMetadata – The agent metadata.\n\nSave the state of a single agent.\n\nThe structure of the state is implementation defined and can be any JSON serializable object.\n\nagent (AgentId) – The agent id.\n\nMapping[str, Any] – The saved state.\n\nLoad the state of a single agent.\n\nagent (AgentId) – The agent id.\n\nstate (Mapping[str, Any]) – The saved state.\n\nRegister an agent factory with the runtime associated with a specific type. The type must be unique. This API does not add any subscriptions.\n\nThis is a low level API and usually the agent class’s register method should be used instead, as this also handles subscriptions automatically.\n\ntype (str) – The type of agent this factory creates. It is not the same as agent class name. The type parameter is used to differentiate between different factory functions rather than agent classes.\n\nagent_factory (Callable[[], T]) – The factory that creates the agent, where T is a concrete Agent type. Inside the factory, use autogen_core.AgentInstantiationContext to access variables like the current runtime and agent ID.\n\nexpected_class (type[T] | None, optional) – The expected class of the agent, used for runtime validation of the factory. Defaults to None. If None, no validation is performed.\n\nRegister an agent instance with the runtime. The type may be reused, but each agent_id must be unique. All agent instances within a type must be of the same object type. This API does not add any subscriptions.\n\nThis is a low level API and usually the agent class’s register_instance method should be used instead, as this also handles subscriptions automatically.\n\nagent_instance (Agent) – A concrete instance of the agent.\n\nagent_id (AgentId) – The agent’s identifier. The agent’s type is agent_id.type.\n\nTry to get the underlying agent instance by name and namespace. This is generally discouraged (hence the long name), but can be useful in some cases.\n\nIf the underlying agent is not accessible, this will raise an exception.\n\nid (AgentId) – The agent id.\n\ntype (Type[T], optional) – The expected type of the agent. Defaults to Agent.\n\nT – The concrete agent instance.\n\nLookupError – If the agent is not found.\n\nNotAccessibleError – If the agent is not accessible, for example if it is located remotely.\n\nTypeError – If the agent is not of the expected type.\n\nAdd a new subscription that the runtime should fulfill when processing published messages\n\nsubscription (Subscription) – The subscription to add\n\nRemove a subscription from the runtime\n\nid (str) – id of the subscription to remove\n\nLookupError – If the subscription does not exist\n\nAdd a new message serialization serializer to the runtime\n\nNote: This will deduplicate serializers based on the type_name and data_content_type properties\n\nserializer (MessageSerializer[Any] | Sequence[MessageSerializer[Any]]) – The serializer/s to add\n\nStart the server in a background task.\n\nStop the server when a signal is received.\n\nBases: AgentRpcServicer\n\nA gRPC servicer that hosts message delivery service for agents.\n\nMissing associated documentation comment in .proto file.\n\nMissing associated documentation comment in .proto file.\n\nMissing associated documentation comment in .proto file.\n\nMissing associated documentation comment in .proto file.\n\nMissing associated documentation comment in .proto file.\n\nMissing associated documentation comment in .proto file.\n\nautogen_ext.models.semantic_kernel\n\nautogen_ext.teams.magentic_one",
  "headings": [
    {
      "level": "h1",
      "text": "autogen_ext.runtimes.grpc#",
      "id": ""
    }
  ],
  "code_samples": [
    {
      "code": "from dataclasses import dataclass\n\nfrom autogen_core import AgentRuntime, MessageContext, RoutedAgent, event\nfrom autogen_core.models import UserMessage\n\n\n@dataclass\nclass MyMessage:\n    content: str\n\n\nclass MyAgent(RoutedAgent):\n    def __init__(self) -> None:\n        super().__init__(\"My core agent\")\n\n    @event\n    async def handler(self, message: UserMessage, context: MessageContext) -> None:\n        print(\"Event received: \", message.content)\n\n\nasync def my_agent_factory():\n    return MyAgent()\n\n\nasync def main() -> None:\n    runtime: AgentRuntime = ...  # type: ignore\n    await runtime.register_factory(\"my_agent\", lambda: MyAgent())\n\n\nimport asyncio\n\nasyncio.run(main())",
      "language": "python"
    },
    {
      "code": "from dataclasses import dataclass\n\nfrom autogen_core import AgentRuntime, MessageContext, RoutedAgent, event\nfrom autogen_core.models import UserMessage\n\n\n@dataclass\nclass MyMessage:\n    content: str\n\n\nclass MyAgent(RoutedAgent):\n    def __init__(self) -> None:\n        super().__init__(\"My core agent\")\n\n    @event\n    async def handler(self, message: UserMessage, context: MessageContext) -> None:\n        print(\"Event received: \", message.content)\n\n\nasync def my_agent_factory():\n    return MyAgent()\n\n\nasync def main() -> None:\n    runtime: AgentRuntime = ...  # type: ignore\n    await runtime.register_factory(\"my_agent\", lambda: MyAgent())\n\n\nimport asyncio\n\nasyncio.run(main())",
      "language": "python"
    },
    {
      "code": "from dataclasses import dataclass\n\nfrom autogen_core import AgentId, AgentRuntime, MessageContext, RoutedAgent, event\nfrom autogen_core.models import UserMessage\n\n\n@dataclass\nclass MyMessage:\n    content: str\n\n\nclass MyAgent(RoutedAgent):\n    def __init__(self) -> None:\n        super().__init__(\"My core agent\")\n\n    @event\n    async def handler(self, message: UserMessage, context: MessageContext) -> None:\n        print(\"Event received: \", message.content)\n\n\nasync def main() -> None:\n    runtime: AgentRuntime = ...  # type: ignore\n    agent = MyAgent()\n    await runtime.register_agent_instance(\n        agent_instance=agent, agent_id=AgentId(type=\"my_agent\", key=\"default\")\n    )\n\n\nimport asyncio\n\nasyncio.run(main())",
      "language": "python"
    },
    {
      "code": "from dataclasses import dataclass\n\nfrom autogen_core import AgentId, AgentRuntime, MessageContext, RoutedAgent, event\nfrom autogen_core.models import UserMessage\n\n\n@dataclass\nclass MyMessage:\n    content: str\n\n\nclass MyAgent(RoutedAgent):\n    def __init__(self) -> None:\n        super().__init__(\"My core agent\")\n\n    @event\n    async def handler(self, message: UserMessage, context: MessageContext) -> None:\n        print(\"Event received: \", message.content)\n\n\nasync def main() -> None:\n    runtime: AgentRuntime = ...  # type: ignore\n    agent = MyAgent()\n    await runtime.register_agent_instance(\n        agent_instance=agent, agent_id=AgentId(type=\"my_agent\", key=\"default\")\n    )\n\n\nimport asyncio\n\nasyncio.run(main())",
      "language": "python"
    }
  ],
  "patterns": [
    {
      "description": "API Reference autogen_ext.runtimes.grpc autogen_ext.runtimes.grpc# class GrpcWorkerAgentRuntime(host_address: str, tracer_provider: TracerProvider | None = None, extra_grpc_config: Sequence[Tuple[str, Any]] | None = None, payload_serialization_format: str = JSON_DATA_CONTENT_TYPE)[source]# Bases: AgentRuntime An agent runtime for running remote or cross-language agents. Agent messaging uses protobufs from agent_worker.proto and CloudEvent from cloudevent.proto. Cross-language agents will additionally require all agents use shared protobuf schemas for any message types that are sent between agents. async start() → None[source]# Start the runtime in a background task. async stop() → None[source]# Stop the runtime immediately. async stop_when_signal(signals: Sequence[Signals] = (signal.SIGTERM, signal.SIGINT)) → None[source]# Stop the runtime when a signal is received. async send_message(message: Any, recipient: AgentId, *, sender: AgentId | None = None, cancellation_token: CancellationToken | None = None, message_id: str | None = None) → Any[source]# Send a message to an agent and get a response. Parameters: message (Any) – The message to send. recipient (AgentId) – The agent to send the message to. sender (AgentId | None, optional) – Agent which sent the message. Should only be None if this was sent from no agent, such as directly to the runtime externally. Defaults to None. cancellation_token (CancellationToken | None, optional) – Token used to cancel an in progress . Defaults to None. Raises: CantHandleException – If the recipient cannot handle the message. UndeliverableException – If the message cannot be delivered. Other – Any other exception raised by the recipient. Returns: Any – The response from the agent. async publish_message(message: Any, topic_id: TopicId, *, sender: AgentId | None = None, cancellation_token: CancellationToken | None = None, message_id: str | None = None) → None[source]# Publish a message to all agents in the given namespace, or if no namespace is provided, the namespace of the sender. No responses are expected from publishing. Parameters: message (Any) – The message to publish. topic_id (TopicId) – The topic to publish the message to. sender (AgentId | None, optional) – The agent which sent the message. Defaults to None. cancellation_token (CancellationToken | None, optional) – Token used to cancel an in progress. Defaults to None. message_id (str | None, optional) – The message id. If None, a new message id will be generated. Defaults to None. This message id must be unique. and is recommended to be a UUID. Raises: UndeliverableException – If the message cannot be delivered. async save_state() → Mapping[str, Any][source]# Save the state of the entire runtime, including all hosted agents. The only way to restore the state is to pass it to load_state(). The structure of the state is implementation defined and can be any JSON serializable object. Returns: Mapping[str, Any] – The saved state. async load_state(state: Mapping[str, Any]) → None[source]# Load the state of the entire runtime, including all hosted agents. The state should be the same as the one returned by save_state(). Parameters: state (Mapping[str, Any]) – The saved state. async agent_metadata(agent: AgentId) → AgentMetadata[source]# Get the metadata for an agent. Parameters: agent (AgentId) – The agent id. Returns: AgentMetadata – The agent metadata. async agent_save_state(agent: AgentId) → Mapping[str, Any][source]# Save the state of a single agent. The structure of the state is implementation defined and can be any JSON serializable object. Parameters: agent (AgentId) – The agent id. Returns: Mapping[str, Any] – The saved state. async agent_load_state(agent: AgentId, state: Mapping[str, Any]) → None[source]# Load the state of a single agent. Parameters: agent (AgentId) – The agent id. state (Mapping[str, Any]) – The saved state. async register_factory(type: str | AgentType, agent_factory: Callable[[], T | Awaitable[T]], *, expected_class: type[T] | None = None) → AgentType[source]# Register an agent factory with the runtime associated with a specific type. The type must be unique. This API does not add any subscriptions. Note This is a low level API and usually the agent class’s register method should be used instead, as this also handles subscriptions automatically. Example: from dataclasses import dataclass from autogen_core import AgentRuntime, MessageContext, RoutedAgent, event from autogen_core.models import UserMessage @dataclass class MyMessage: content: str class MyAgent(RoutedAgent): def __init__(self) -> None: super().__init__(\"My core agent\") @event async def handler(self, message: UserMessage, context: MessageContext) -> None: print(\"Event received: \", message.content) async def my_agent_factory(): return MyAgent() async def main() -> None: runtime: AgentRuntime = ... # type: ignore await runtime.register_factory(\"my_agent\", lambda: MyAgent()) import asyncio asyncio.run(main()) Parameters: type (str) – The type of agent this factory creates. It is not the same as agent class name. The type parameter is used to differentiate between different factory functions rather than agent classes. agent_factory (Callable[[], T]) – The factory that creates the agent, where T is a concrete Agent type. Inside the factory, use autogen_core.AgentInstantiationContext to access variables like the current runtime and agent ID. expected_class (type[T] | None, optional) – The expected class of the agent, used for runtime validation of the factory. Defaults to None. If None, no validation is performed. async register_agent_instance(agent_instance: Agent, agent_id: AgentId) → AgentId[source]# Register an agent instance with the runtime. The type may be reused, but each agent_id must be unique. All agent instances within a type must be of the same object type. This API does not add any subscriptions. Note This is a low level API and usually the agent class’s register_instance method should be used instead, as this also handles subscriptions automatically. Example: from dataclasses import dataclass from autogen_core import AgentId, AgentRuntime, MessageContext, RoutedAgent, event from autogen_core.models import UserMessage @dataclass class MyMessage: content: str class MyAgent(RoutedAgent): def __init__(self) -> None: super().__init__(\"My core agent\") @event async def handler(self, message: UserMessage, context: MessageContext) -> None: print(\"Event received: \", message.content) async def main() -> None: runtime: AgentRuntime = ... # type: ignore agent = MyAgent() await runtime.register_agent_instance( agent_instance=agent, agent_id=AgentId(type=\"my_agent\", key=\"default\") ) import asyncio asyncio.run(main()) Parameters: agent_instance (Agent) – A concrete instance of the agent. agent_id (AgentId) – The agent’s identifier. The agent’s type is agent_id.type. async try_get_underlying_agent_instance(id: AgentId, type: Type[T] = Agent) → T[source]# Try to get the underlying agent instance by name and namespace. This is generally discouraged (hence the long name), but can be useful in some cases. If the underlying agent is not accessible, this will raise an exception. Parameters: id (AgentId) – The agent id. type (Type[T], optional) – The expected type of the agent. Defaults to Agent. Returns: T – The concrete agent instance. Raises: LookupError – If the agent is not found. NotAccessibleError – If the agent is not accessible, for example if it is located remotely. TypeError – If the agent is not of the expected type. async add_subscription(subscription: Subscription) → None[source]# Add a new subscription that the runtime should fulfill when processing published messages Parameters: subscription (Subscription) – The subscription to add async remove_subscription(id: str) → None[source]# Remove a subscription from the runtime Parameters: id (str) – id of the subscription to remove Raises: LookupError – If the subscription does not exist async get(id_or_type: AgentId | AgentType | str, /, key: str = 'default', *, lazy: bool = True) → AgentId[source]# add_message_serializer(serializer: MessageSerializer[Any] | Sequence[MessageSerializer[Any]]) → None[source]# Add a new message serialization serializer to the runtime Note: This will deduplicate serializers based on the type_name and data_content_type properties Parameters: serializer (MessageSerializer[Any] | Sequence[MessageSerializer[Any]]) – The serializer/s to add class GrpcWorkerAgentRuntimeHost(address: str, extra_grpc_config: Sequence[Tuple[str, Any]] | None = None)[source]# Bases: object start() → None[source]# Start the server in a background task. async stop(grace: int = 5) → None[source]# Stop the server. async stop_when_signal(grace: int = 5, signals: Sequence[Signals] = (signal.SIGTERM, signal.SIGINT)) → None[source]# Stop the server when a signal is received. class GrpcWorkerAgentRuntimeHostServicer[source]# Bases: AgentRpcServicer A gRPC servicer that hosts message delivery service for agents. async OpenChannel(request_iterator: AsyncIterator[Message], context: ServicerContext[Message, Message]) → AsyncIterator[Message][source]# Missing associated documentation comment in .proto file. async OpenControlChannel(request_iterator: AsyncIterator[ControlMessage], context: ServicerContext[ControlMessage, ControlMessage]) → AsyncIterator[ControlMessage][source]# Missing associated documentation comment in .proto file. async RegisterAgent(request: RegisterAgentTypeRequest, context: ServicerContext[RegisterAgentTypeRequest, RegisterAgentTypeResponse]) → RegisterAgentTypeResponse[source]# Missing associated documentation comment in .proto file. async AddSubscription(request: AddSubscriptionRequest, context: ServicerContext[AddSubscriptionRequest, AddSubscriptionResponse]) → AddSubscriptionResponse[source]# Missing associated documentation comment in .proto file. async RemoveSubscription(request: RemoveSubscriptionRequest, context: ServicerContext[RemoveSubscriptionRequest, RemoveSubscriptionResponse]) → RemoveSubscriptionResponse[source]# Missing associated documentation comment in .proto file. async GetSubscriptions(request: GetSubscriptionsRequest, context: ServicerContext[GetSubscriptionsRequest, GetSubscriptionsResponse]) → GetSubscriptionsResponse[source]# Missing associated documentation comment in .proto file. previous autogen_ext.models.semantic_kernel next autogen_ext.teams.magentic_one On this page GrpcWorkerAgentRuntime GrpcWorkerAgentRuntime.start() GrpcWorkerAgentRuntime.stop() GrpcWorkerAgentRuntime.stop_when_signal() GrpcWorkerAgentRuntime.send_message() GrpcWorkerAgentRuntime.publish_message() GrpcWorkerAgentRuntime.save_state() GrpcWorkerAgentRuntime.load_state() GrpcWorkerAgentRuntime.agent_metadata() GrpcWorkerAgentRuntime.agent_save_state() GrpcWorkerAgentRuntime.agent_load_state() GrpcWorkerAgentRuntime.register_factory() GrpcWorkerAgentRuntime.register_agent_instance() GrpcWorkerAgentRuntime.try_get_underlying_agent_instance() GrpcWorkerAgentRuntime.add_subscription() GrpcWorkerAgentRuntime.remove_subscription() GrpcWorkerAgentRuntime.get() GrpcWorkerAgentRuntime.add_message_serializer() GrpcWorkerAgentRuntimeHost GrpcWorkerAgentRuntimeHost.start() GrpcWorkerAgentRuntimeHost.stop() GrpcWorkerAgentRuntimeHost.stop_when_signal() GrpcWorkerAgentRuntimeHostServicer GrpcWorkerAgentRuntimeHostServicer.OpenChannel() GrpcWorkerAgentRuntimeHostServicer.OpenControlChannel() GrpcWorkerAgentRuntimeHostServicer.RegisterAgent() GrpcWorkerAgentRuntimeHostServicer.AddSubscription() GrpcWorkerAgentRuntimeHostServicer.RemoveSubscription() GrpcWorkerAgentRuntimeHostServicer.GetSubscriptions() Edit on GitHub Show Source",
      "code": "AgentRuntime"
    },
    {
      "description": "API Reference autogen_ext.runtimes.grpc autogen_ext.runtimes.grpc# class GrpcWorkerAgentRuntime(host_address: str, tracer_provider: TracerProvider | None = None, extra_grpc_config: Sequence[Tuple[str, Any]] | None = None, payload_serialization_format: str = JSON_DATA_CONTENT_TYPE)[source]# Bases: AgentRuntime An agent runtime for running remote or cross-language agents. Agent messaging uses protobufs from agent_worker.proto and CloudEvent from cloudevent.proto. Cross-language agents will additionally require all agents use shared protobuf schemas for any message types that are sent between agents. async start() → None[source]# Start the runtime in a background task. async stop() → None[source]# Stop the runtime immediately. async stop_when_signal(signals: Sequence[Signals] = (signal.SIGTERM, signal.SIGINT)) → None[source]# Stop the runtime when a signal is received. async send_message(message: Any, recipient: AgentId, *, sender: AgentId | None = None, cancellation_token: CancellationToken | None = None, message_id: str | None = None) → Any[source]# Send a message to an agent and get a response. Parameters: message (Any) – The message to send. recipient (AgentId) – The agent to send the message to. sender (AgentId | None, optional) – Agent which sent the message. Should only be None if this was sent from no agent, such as directly to the runtime externally. Defaults to None. cancellation_token (CancellationToken | None, optional) – Token used to cancel an in progress . Defaults to None. Raises: CantHandleException – If the recipient cannot handle the message. UndeliverableException – If the message cannot be delivered. Other – Any other exception raised by the recipient. Returns: Any – The response from the agent. async publish_message(message: Any, topic_id: TopicId, *, sender: AgentId | None = None, cancellation_token: CancellationToken | None = None, message_id: str | None = None) → None[source]# Publish a message to all agents in the given namespace, or if no namespace is provided, the namespace of the sender. No responses are expected from publishing. Parameters: message (Any) – The message to publish. topic_id (TopicId) – The topic to publish the message to. sender (AgentId | None, optional) – The agent which sent the message. Defaults to None. cancellation_token (CancellationToken | None, optional) – Token used to cancel an in progress. Defaults to None. message_id (str | None, optional) – The message id. If None, a new message id will be generated. Defaults to None. This message id must be unique. and is recommended to be a UUID. Raises: UndeliverableException – If the message cannot be delivered. async save_state() → Mapping[str, Any][source]# Save the state of the entire runtime, including all hosted agents. The only way to restore the state is to pass it to load_state(). The structure of the state is implementation defined and can be any JSON serializable object. Returns: Mapping[str, Any] – The saved state. async load_state(state: Mapping[str, Any]) → None[source]# Load the state of the entire runtime, including all hosted agents. The state should be the same as the one returned by save_state(). Parameters: state (Mapping[str, Any]) – The saved state. async agent_metadata(agent: AgentId) → AgentMetadata[source]# Get the metadata for an agent. Parameters: agent (AgentId) – The agent id. Returns: AgentMetadata – The agent metadata. async agent_save_state(agent: AgentId) → Mapping[str, Any][source]# Save the state of a single agent. The structure of the state is implementation defined and can be any JSON serializable object. Parameters: agent (AgentId) – The agent id. Returns: Mapping[str, Any] – The saved state. async agent_load_state(agent: AgentId, state: Mapping[str, Any]) → None[source]# Load the state of a single agent. Parameters: agent (AgentId) – The agent id. state (Mapping[str, Any]) – The saved state. async register_factory(type: str | AgentType, agent_factory: Callable[[], T | Awaitable[T]], *, expected_class: type[T] | None = None) → AgentType[source]# Register an agent factory with the runtime associated with a specific type. The type must be unique. This API does not add any subscriptions. Note This is a low level API and usually the agent class’s register method should be used instead, as this also handles subscriptions automatically. Example: from dataclasses import dataclass from autogen_core import AgentRuntime, MessageContext, RoutedAgent, event from autogen_core.models import UserMessage @dataclass class MyMessage: content: str class MyAgent(RoutedAgent): def __init__(self) -> None: super().__init__(\"My core agent\") @event async def handler(self, message: UserMessage, context: MessageContext) -> None: print(\"Event received: \", message.content) async def my_agent_factory(): return MyAgent() async def main() -> None: runtime: AgentRuntime = ... # type: ignore await runtime.register_factory(\"my_agent\", lambda: MyAgent()) import asyncio asyncio.run(main()) Parameters: type (str) – The type of agent this factory creates. It is not the same as agent class name. The type parameter is used to differentiate between different factory functions rather than agent classes. agent_factory (Callable[[], T]) – The factory that creates the agent, where T is a concrete Agent type. Inside the factory, use autogen_core.AgentInstantiationContext to access variables like the current runtime and agent ID. expected_class (type[T] | None, optional) – The expected class of the agent, used for runtime validation of the factory. Defaults to None. If None, no validation is performed. async register_agent_instance(agent_instance: Agent, agent_id: AgentId) → AgentId[source]# Register an agent instance with the runtime. The type may be reused, but each agent_id must be unique. All agent instances within a type must be of the same object type. This API does not add any subscriptions. Note This is a low level API and usually the agent class’s register_instance method should be used instead, as this also handles subscriptions automatically. Example: from dataclasses import dataclass from autogen_core import AgentId, AgentRuntime, MessageContext, RoutedAgent, event from autogen_core.models import UserMessage @dataclass class MyMessage: content: str class MyAgent(RoutedAgent): def __init__(self) -> None: super().__init__(\"My core agent\") @event async def handler(self, message: UserMessage, context: MessageContext) -> None: print(\"Event received: \", message.content) async def main() -> None: runtime: AgentRuntime = ... # type: ignore agent = MyAgent() await runtime.register_agent_instance( agent_instance=agent, agent_id=AgentId(type=\"my_agent\", key=\"default\") ) import asyncio asyncio.run(main()) Parameters: agent_instance (Agent) – A concrete instance of the agent. agent_id (AgentId) – The agent’s identifier. The agent’s type is agent_id.type. async try_get_underlying_agent_instance(id: AgentId, type: Type[T] = Agent) → T[source]# Try to get the underlying agent instance by name and namespace. This is generally discouraged (hence the long name), but can be useful in some cases. If the underlying agent is not accessible, this will raise an exception. Parameters: id (AgentId) – The agent id. type (Type[T], optional) – The expected type of the agent. Defaults to Agent. Returns: T – The concrete agent instance. Raises: LookupError – If the agent is not found. NotAccessibleError – If the agent is not accessible, for example if it is located remotely. TypeError – If the agent is not of the expected type. async add_subscription(subscription: Subscription) → None[source]# Add a new subscription that the runtime should fulfill when processing published messages Parameters: subscription (Subscription) – The subscription to add async remove_subscription(id: str) → None[source]# Remove a subscription from the runtime Parameters: id (str) – id of the subscription to remove Raises: LookupError – If the subscription does not exist async get(id_or_type: AgentId | AgentType | str, /, key: str = 'default', *, lazy: bool = True) → AgentId[source]# add_message_serializer(serializer: MessageSerializer[Any] | Sequence[MessageSerializer[Any]]) → None[source]# Add a new message serialization serializer to the runtime Note: This will deduplicate serializers based on the type_name and data_content_type properties Parameters: serializer (MessageSerializer[Any] | Sequence[MessageSerializer[Any]]) – The serializer/s to add class GrpcWorkerAgentRuntimeHost(address: str, extra_grpc_config: Sequence[Tuple[str, Any]] | None = None)[source]# Bases: object start() → None[source]# Start the server in a background task. async stop(grace: int = 5) → None[source]# Stop the server. async stop_when_signal(grace: int = 5, signals: Sequence[Signals] = (signal.SIGTERM, signal.SIGINT)) → None[source]# Stop the server when a signal is received. class GrpcWorkerAgentRuntimeHostServicer[source]# Bases: AgentRpcServicer A gRPC servicer that hosts message delivery service for agents. async OpenChannel(request_iterator: AsyncIterator[Message], context: ServicerContext[Message, Message]) → AsyncIterator[Message][source]# Missing associated documentation comment in .proto file. async OpenControlChannel(request_iterator: AsyncIterator[ControlMessage], context: ServicerContext[ControlMessage, ControlMessage]) → AsyncIterator[ControlMessage][source]# Missing associated documentation comment in .proto file. async RegisterAgent(request: RegisterAgentTypeRequest, context: ServicerContext[RegisterAgentTypeRequest, RegisterAgentTypeResponse]) → RegisterAgentTypeResponse[source]# Missing associated documentation comment in .proto file. async AddSubscription(request: AddSubscriptionRequest, context: ServicerContext[AddSubscriptionRequest, AddSubscriptionResponse]) → AddSubscriptionResponse[source]# Missing associated documentation comment in .proto file. async RemoveSubscription(request: RemoveSubscriptionRequest, context: ServicerContext[RemoveSubscriptionRequest, RemoveSubscriptionResponse]) → RemoveSubscriptionResponse[source]# Missing associated documentation comment in .proto file. async GetSubscriptions(request: GetSubscriptionsRequest, context: ServicerContext[GetSubscriptionsRequest, GetSubscriptionsResponse]) → GetSubscriptionsResponse[source]# Missing associated documentation comment in .proto file. previous autogen_ext.models.semantic_kernel next autogen_ext.teams.magentic_one",
      "code": "AgentRuntime"
    },
    {
      "description": "Example:",
      "code": "from dataclasses import dataclass\n\nfrom autogen_core import AgentRuntime, MessageContext, RoutedAgent, event\nfrom autogen_core.models import UserMessage\n\n\n@dataclass\nclass MyMessage:\n    content: str\n\n\nclass MyAgent(RoutedAgent):\n    def __init__(self) -> None:\n        super().__init__(\"My core agent\")\n\n    @event\n    async def handler(self, message: UserMessage, context: MessageContext) -> None:\n        print(\"Event received: \", message.content)\n\n\nasync def my_agent_factory():\n    return MyAgent()\n\n\nasync def main() -> None:\n    runtime: AgentRuntime = ...  # type: ignore\n    await runtime.register_factory(\"my_agent\", lambda: MyAgent())\n\n\nimport asyncio\n\nasyncio.run(main())"
    },
    {
      "description": "Example:",
      "code": "from dataclasses import dataclass\n\nfrom autogen_core import AgentId, AgentRuntime, MessageContext, RoutedAgent, event\nfrom autogen_core.models import UserMessage\n\n\n@dataclass\nclass MyMessage:\n    content: str\n\n\nclass MyAgent(RoutedAgent):\n    def __init__(self) -> None:\n        super().__init__(\"My core agent\")\n\n    @event\n    async def handler(self, message: UserMessage, context: MessageContext) -> None:\n        print(\"Event received: \", message.content)\n\n\nasync def main() -> None:\n    runtime: AgentRuntime = ...  # type: ignore\n    agent = MyAgent()\n    await runtime.register_agent_instance(\n        agent_instance=agent, agent_id=AgentId(type=\"my_agent\", key=\"default\")\n    )\n\n\nimport asyncio\n\nasyncio.run(main())"
    }
  ],
  "links": [
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.html",
    "https://microsoft.github.io/autogen/stable/index.html",
    "https://microsoft.github.io/autogen/stable/user-guide/agentchat-user-guide/index.html",
    "https://microsoft.github.io/autogen/stable/user-guide/core-user-guide/index.html",
    "https://microsoft.github.io/autogen/stable/user-guide/extensions-user-guide/index.html",
    "https://microsoft.github.io/autogen/stable/user-guide/autogenstudio-user-guide/index.html",
    "https://microsoft.github.io/autogen/stable/reference/index.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.agents.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.base.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.conditions.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.messages.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.state.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.teams.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.tools.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.ui.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_agentchat.utils.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.code_executor.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.exceptions.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.logging.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.memory.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.model_context.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.models.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.tool_agent.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.tools.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_core.utils.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.cache_store.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.experimental.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.teams.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.ui.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.file_surfer.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.magentic_one.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.openai.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.video_surfer.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.web_surfer.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.auth.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.cache_store.diskcache.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.cache_store.redis.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.docker.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.docker_jupyter.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.jupyter.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.code_executors.local.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.experimental.task_centric_memory.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.canvas.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.chromadb.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.mem0.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.memory.redis.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.anthropic.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.cache.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.llama_cpp.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.ollama.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.openai.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.replay.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.semantic_kernel.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.teams.magentic_one.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.azure.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.code_execution.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.graphrag.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.http.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.langchain.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.mcp.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.tools.semantic_kernel.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.video_surfer.tools.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.agents.web_surfer.playwright_controller.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.experimental.task_centric_memory.utils.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.anthropic.config.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.azure.config.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.ollama.config.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.models.openai.config.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.agent_worker_pb2.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.agent_worker_pb2_grpc.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.cloudevent_pb2.html",
    "https://microsoft.github.io/autogen/stable/reference/python/autogen_ext.runtimes.grpc.protos.cloudevent_pb2_grpc.html"
  ]
}