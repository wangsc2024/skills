{
  "title": "The system prompt will be set dynamically based on context",
  "content": "result = agent.invoke(\n    {\"messages\": [{\"role\": \"user\", \"content\": \"Explain machine learning\"}]},\n    context={\"user_role\": \"expert\"}\n)\npython  theme={null}\nresult = agent.invoke(\n    {\"messages\": [{\"role\": \"user\", \"content\": \"What's the weather in San Francisco?\"}]}\n)\npython wrap theme={null}\nfrom pydantic import BaseModel\nfrom langchain.agents import create_agent\nfrom langchain.agents.structured_output import ToolStrategy\n\nclass ContactInfo(BaseModel):\n    name: str\n    email: str\n    phone: str\n\nagent = create_agent(\n    model=\"gpt-4o-mini\",\n    tools=[search_tool],\n    response_format=ToolStrategy(ContactInfo)\n)\n\nresult = agent.invoke({\n    \"messages\": [{\"role\": \"user\", \"content\": \"Extract contact info from: John Doe, john@example.com, (555) 123-4567\"}]\n})\n\nresult[\"structured_response\"]",
  "code_samples": [
    {
      "code": "<Tip>\n  For more details on message types and formatting, see [Messages](/oss/python/langchain/messages). For comprehensive middleware documentation, see [Middleware](/oss/python/langchain/middleware).\n</Tip>\n\n## Invocation\n\nYou can invoke an agent by passing an update to its [`State`](/oss/python/langgraph/graph-api#state). All agents include a [sequence of messages](/oss/python/langgraph/use-graph-api#messagesstate) in their state; to invoke the agent, pass a new message:",
      "language": "unknown"
    },
    {
      "code": "For streaming steps and / or tokens from the agent, refer to the [streaming](/oss/python/langchain/streaming) guide.\n\nOtherwise, the agent follows the LangGraph [Graph API](/oss/python/langgraph/use-graph-api) and supports all associated methods, such as `stream` and `invoke`.\n\n## Advanced concepts\n\n### Structured output\n\nIn some situations, you may want the agent to return an output in a specific format. LangChain provides strategies for structured output via the `response_format` parameter.\n\n#### ToolStrategy\n\n`ToolStrategy` uses artificial tool calling to generate structured output. This works with any model that supports tool calling:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Invocation",
      "id": "invocation"
    },
    {
      "level": "h2",
      "text": "Advanced concepts",
      "id": "advanced-concepts"
    },
    {
      "level": "h3",
      "text": "Structured output",
      "id": "structured-output"
    }
  ],
  "url": "llms-txt#the-system-prompt-will-be-set-dynamically-based-on-context",
  "links": []
}