{
  "title": "API Reference: https://api.smith.langchain.com/redoc#tag/run/operation/query_runs_api_v1_runs_query_post",
  "content": "runs = requests.post(\n    f\"https://api.smith.langchain.com/api/v1/runs/query\",\n    headers={\"x-api-key\": os.environ[\"LANGSMITH_API_KEY\"]},\n    json={\n        \"session\": experiment_ids,\n        \"is_root\": True, # Only fetch root runs (spans) which contain the end outputs\n        \"select\": [\"id\", \"reference_example_id\", \"outputs\"],\n    }\n).json()\nruns = runs[\"runs\"]\nfor run in runs:\n    example_id = run[\"reference_example_id\"]\n    example_id_to_runs_map[example_id].append(run)\n\nfor example_id, runs in example_id_to_runs_map.items():\n    print(f\"Example ID: {example_id}\")\n    # Preferentially rank the outputs, in this case we will always prefer the first output\n    # In reality, you can use an LLM to rank the outputs\n    feedback_group_id = uuid4()\n\n# Post a feedback score for each run, with the first run being the preferred one\n    # API Reference: https://api.smith.langchain.com/redoc#tag/feedback/operation/create_feedback_api_v1_feedback_post\n    # We'll use the feedback group ID to associate the feedback scores with the same group\n    for i, run in enumerate(runs):\n        print(f\"Run ID: {run['id']}\")\n        feedback = {\n            \"score\": 1 if i == 0 else 0,\n            \"run_id\": str(run[\"id\"]),\n            \"key\": \"ranked_preference\",\n            \"feedback_group_id\": str(feedback_group_id),\n            \"comparative_experiment_id\": comparative_experiment_id,\n        }\n        resp = requests.post(\n            \"https://api.smith.langchain.com/api/v1/feedback\",\n            json=feedback,\n            headers={\"x-api-key\": os.environ[\"LANGSMITH_API_KEY\"]}\n        )\n        resp.raise_for_status()\n```\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit this page on GitHub](https://github.com/langchain-ai/docs/edit/main/src/langsmith/run-evals-api-only.mdx) or [file an issue](https://github.com/langchain-ai/docs/issues/new/choose).\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "code_samples": [],
  "headings": [],
  "url": "llms-txt#api-reference:-https://api.smith.langchain.com/redoc#tag/run/operation/query_runs_api_v1_runs_query_post",
  "links": []
}