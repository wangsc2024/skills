{
  "title": "Run the graph",
  "content": "print(graph.invoke({\"question\": \"hi\"}))\npython  theme={null}\nfrom langchain_mcp_adapters.client import MultiServerMCPClient\n\ndef mcp_tools_node(state, config):\n    user = config[\"configurable\"].get(\"langgraph_auth_user\")\n         , user[\"github_token\"], user[\"email\"], etc.\n\nclient = MultiServerMCPClient({\n        \"github\": {\n            \"transport\": \"streamable_http\", # (1)\n            \"url\": \"https://my-github-mcp-server/mcp\", # (2)\n            \"headers\": {\n                \"Authorization\": f\"Bearer {user['github_token']}\"\n            }\n        }\n    })\n    tools = await client.get_tools() # (3)\n\n# Your tool-calling logic here\n\ntool_messages = ...\n    return {\"messages\": tool_messages}\njson  theme={null}\n{\n  \"$schema\": \"https://langgra.ph/schema.json\",\n  \"http\": {\n    \"disable_mcp\": true\n  }\n}\n```\n\nThis will prevent the server from exposing the `/mcp` endpoint.\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit this page on GitHub](https://github.com/langchain-ai/docs/edit/main/src/langsmith/server-mcp.mdx) or [file an issue](https://github.com/langchain-ai/docs/issues/new/choose).\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "code_samples": [
    {
      "code": "For more details, see the [low-level concepts guide](/oss/python/langgraph/graph-api#state).\n\n## Use user-scoped MCP tools in your deployment\n\n<Tip>\n  **Prerequisites**\n  You have added your own [custom auth middleware](/langsmith/custom-auth) that populates the `langgraph_auth_user` object, making it accessible through configurable context for every node in your graph.\n</Tip>\n\nTo make user-scoped tools available to your LangSmith deployment, start with implementing a snippet like the following:",
      "language": "unknown"
    },
    {
      "code": "1. MCP only supports adding headers to requests made to `streamable_http` and `sse` `transport` servers.\n2. Your MCP server URL.\n3. Get available tools from your MCP server.\n\n*This can also be done by [rebuilding your graph at runtime](/langsmith/graph-rebuild) to have a different configuration for a new run*\n\n## Session behavior\n\nThe current LangGraph MCP implementation does not support sessions. Each `/mcp` request is stateless and independent.\n\n## Authentication\n\nThe `/mcp` endpoint uses the same authentication as the rest of the LangGraph API. Refer to the [authentication guide](/langsmith/auth) for setup details.\n\n## Disable MCP\n\nTo disable the MCP endpoint, set `disable_mcp` to `true` in your `langgraph.json` configuration file:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Use user-scoped MCP tools in your deployment",
      "id": "use-user-scoped-mcp-tools-in-your-deployment"
    },
    {
      "level": "h2",
      "text": "Session behavior",
      "id": "session-behavior"
    },
    {
      "level": "h2",
      "text": "Authentication",
      "id": "authentication"
    },
    {
      "level": "h2",
      "text": "Disable MCP",
      "id": "disable-mcp"
    }
  ],
  "url": "llms-txt#run-the-graph",
  "links": []
}