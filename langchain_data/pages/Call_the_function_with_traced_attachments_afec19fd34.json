{
  "title": "Call the function with traced attachments",
  "content": "result = trace_with_attachments(\n    val=val,\n    text=text,\n    image=image_attachment,\n    audio=audio_attachment,\n    video=video_attachment,\n    pdf=pdf_attachment,\n    csv=csv_attachment,\n)\ntypescript TypeScript theme={null}\ntype AttachmentData = Uint8Array | ArrayBuffer;\ntype Attachments = Record<string, [string, AttachmentData]>;\n\nextractAttachments?: (\n    ...args: Parameters<Func>\n) => [Attachments | undefined, KVMap];\ntypescript TypeScript theme={null}\nimport { traceable } from \"langsmith/traceable\";\n\nconst traceableWithAttachments = traceable(\n    (\n        val: number,\n        text: string,\n        attachment: Uint8Array,\n        attachment2: ArrayBuffer,\n        attachment3: Uint8Array,\n        attachment4: ArrayBuffer,\n        attachment5: Uint8Array,\n    ) =>\n        `Processed: ${val}, ${text}, ${attachment.length}, ${attachment2.byteLength}, ${attachment3.length}, ${attachment4.byteLength}, ${attachment5.byteLength}`,\n    {\n        name: \"traceWithAttachments\",\n        extractAttachments: (\n            val: number,\n            text: string,\n            attachment: Uint8Array,\n            attachment2: ArrayBuffer,\n            attachment3: Uint8Array,\n            attachment4: ArrayBuffer,\n            attachment5: Uint8Array,\n        ) => [\n            {\n                \"image inputs\": [\"image/png\", attachment],\n                \"mp3 inputs\": [\"audio/mpeg\", new Uint8Array(attachment2)],\n                \"video inputs\": [\"video/mp4\", attachment3],\n                \"pdf inputs\": [\"application/pdf\", new Uint8Array(attachment4)],\n                \"csv inputs\": [\"text/csv\", new Uint8Array(attachment5)],\n            },\n            { val, text },\n        ],\n    }\n);\n\nconst fs = Deno // or Node.js fs module\nconst image = await fs.readFile(\"my_image.png\"); // Uint8Array\nconst mp3Buffer = await fs.readFile(\"my_mp3.mp3\");\nconst mp3ArrayBuffer = mp3Buffer.buffer; // Convert to ArrayBuffer\nconst video = await fs.readFile(\"my_video.mp4\"); // Uint8Array\nconst pdfBuffer = await fs.readFile(\"my_document.pdf\");\nconst pdfArrayBuffer = pdfBuffer.buffer; // Convert to ArrayBuffer\nconst csv = await fs.readFile(\"test-vals.csv\"); // Uint8Array\n\n// Define example parameters\nconst val = 42;\nconst text = \"Hello, world!\";\n\n// Call traceableWithAttachments with the files\nconst result = await traceableWithAttachments(\n    val, text, image, mp3ArrayBuffer, video, pdfArrayBuffer, csv\n);\n```\n\nHere is how the above would look in the LangSmith UI. You can expand each attachment to view its contents.\n\n<img src=\"https://mintcdn.com/langchain-5e9cc07a/ImHGLQW1HnQYwnJV/langsmith/images/trace-with-attachments.png?fit=max&auto=format&n=ImHGLQW1HnQYwnJV&q=85&s=cb21a1c6d8904d1d7b2215652a6127a5\" alt=\"Trace with attachments\" data-og-width=\"3012\" width=\"3012\" data-og-height=\"1696\" height=\"1696\" data-path=\"langsmith/images/trace-with-attachments.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/langchain-5e9cc07a/ImHGLQW1HnQYwnJV/langsmith/images/trace-with-attachments.png?w=280&fit=max&auto=format&n=ImHGLQW1HnQYwnJV&q=85&s=4caa7aaa44cd296b2f30ff8d6f6d7199 280w, https://mintcdn.com/langchain-5e9cc07a/ImHGLQW1HnQYwnJV/langsmith/images/trace-with-attachments.png?w=560&fit=max&auto=format&n=ImHGLQW1HnQYwnJV&q=85&s=01a4392a7dbf3d10184778d2ab3737a1 560w, https://mintcdn.com/langchain-5e9cc07a/ImHGLQW1HnQYwnJV/langsmith/images/trace-with-attachments.png?w=840&fit=max&auto=format&n=ImHGLQW1HnQYwnJV&q=85&s=e8047eabe350453619c255e88d6fe1d5 840w, https://mintcdn.com/langchain-5e9cc07a/ImHGLQW1HnQYwnJV/langsmith/images/trace-with-attachments.png?w=1100&fit=max&auto=format&n=ImHGLQW1HnQYwnJV&q=85&s=9b0bbb43e10ea30cf466fb65502af907 1100w, https://mintcdn.com/langchain-5e9cc07a/ImHGLQW1HnQYwnJV/langsmith/images/trace-with-attachments.png?w=1650&fit=max&auto=format&n=ImHGLQW1HnQYwnJV&q=85&s=0060d9877954b82d34593d8789f7d0a5 1650w, https://mintcdn.com/langchain-5e9cc07a/ImHGLQW1HnQYwnJV/langsmith/images/trace-with-attachments.png?w=2500&fit=max&auto=format&n=ImHGLQW1HnQYwnJV&q=85&s=ec15ad89f02769defc2d5f5637d88e11 2500w\" />\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit this page on GitHub](https://github.com/langchain-ai/docs/edit/main/src/langsmith/upload-files-with-traces.mdx) or [file an issue](https://github.com/langchain-ai/docs/issues/new/choose).\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "code_samples": [
    {
      "code": "### TypeScript\n\nIn the TypeScript SDK, you can add attachments to traces by using `Uint8Array` or `ArrayBuffer` as data types. Each attachment's MIME type is specified within `extractAttachments`:\n\n* `Uint8Array`: Useful for handling binary data directly.\n* `ArrayBuffer`: Represents fixed-length binary data, which can be converted to `Uint8Array` as needed.\n\nWrap your function with `traceable` and include your attachments within the `extractAttachments` option.\n\nIn the TypeScript SDK, the `extractAttachments` function is an optional parameter in the `traceable` configuration. When the traceable-wrapped function is invoked, it extracts binary data (e.g., images, audio files) from your inputs and logs them alongside other trace data, specifying their MIME types.\n\nNote that you cannot directly pass in a file path in the TypeScript SDK, as accessing local files is not supported in all runtime environments.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h3",
      "text": "TypeScript",
      "id": "typescript"
    }
  ],
  "url": "llms-txt#call-the-function-with-traced-attachments",
  "links": []
}