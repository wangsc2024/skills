{
  "title": "Improve LLM-as-judge evaluators using human feedback",
  "content": "Source: https://docs.langchain.com/langsmith/improve-judge-evaluator-feedback\n\n<Check>\n  Before working through this page, it might be helpful to read the following:\n\n* [Evaluation concepts](/langsmith/evaluation-concepts#evaluators)\n  * [Creating LLM-as-a-judge evaluators](/langsmith/llm-as-judge)\n</Check>\n\nReliable [*LLM-as-a-judge evaluators*](/langsmith/evaluation-concepts#llm-as-judge) are critical for making informed decisions about your AI applications (e.g., prompt, model, architecture changes). Defining the evaluator prompt correctly can be difficult, but it directly affects the trustworthiness of your evaluations.\n\nThis guide describes how to align your LLM-as-a-judge evaluator using human feedback to improve your evaluator's quality and help you build reliable AI applications.\n\nLangSmith's **Align Evaluator** feature has a series of steps that help you align your LLM-as-a-judge evaluator with human expert feedback. You can use this feature to align evaluators that run on a dataset for [offline evaluations](/langsmith/evaluation-concepts#offline-evaluation) or for [online evaluations](/langsmith/evaluation-concepts#online-evaluation). In either case, the steps are similar:\n\n1. **Select experiments or runs** that contain outputs from your application.\n2. Add the selected experiments or runs to an **annotation queue** where a human expert can label the data.\n3. **Test your LLM-as-a-judge evaluator prompt** against the labeled examples. Check the cases where your evaluator result is not aligned with the labeled data. This indicates areas where your evaluator prompt needs improvement.\n4. **Refine and repeat** to improve evaluator alignment. Update your LLM-as-a-judge evaluator prompt and test again.\n\nYou'll need the following before starting this guide for [offline evaluations](#offline-evaluations) or [online evaluations](#online-evaluations):\n\n### Offline evaluations\n\n* A [dataset](/langsmith/evaluation-concepts#datasets) with at least one [experiment](/langsmith/evaluation-concepts#experiment).\n* You'll need to upload or create datasets via the [SDK](/langsmith/manage-datasets-programmatically#create-a-dataset) or the [UI](/langsmith/manage-datasets-in-application#set-up-your-dataset) and run an experiment via the [SDK](/langsmith/evaluate-llm-application#run-the-evaluation) or the [Playground](/langsmith/run-evaluation-from-prompt-playground#5-run-your-evaluation).\n\n### Online evaluations\n\n* An application that’s already sending traces to LangSmith.\n* Configure this with one of the [tracing integrations](/langsmith/observability-concepts#integrations) to start.\n\nYou can enter the alignment flow for both new and existing evaluators in datasets and tracing projects.\n\n|                                              | Dataset Evaluators                                                                                                                                                                                     | Tracing Project Evaluators                                                                                                                                                                         |\n| -------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **Create an aligned evaluator from scratch** | 1. **Datasets & Experiments** and select your dataset<br />2. Click **+ Evaluator** > **Create from labeled data**<br />3. Enter a descriptive feedback key name (e.g. `correctness`, `hallucination`) | 1. **Projects** and select your project<br />2. Click **+ New** > **Evaluator** > **Create from labeled data**<br />3. Enter a descriptive feedback‑key name (e.g. `correctness`, `hallucination`) |\n| **Align an existing evaluator**              | 1. **Datasets & Experiments** > select your dataset > **Evaluators** tab<br />2. In the **Align Evaluator with experiment data** box, click **Select Experiments**                                     | 1. **Projects** > select your project > **Evaluators** tab<br />2. In the **Align Evaluator with experiment data** box, click **Select Experiments**                                               |\n\n## 1. Select experiments or runs\n\nSelect one or more experiments (or runs) to send for human labeling. This will add runs to an [annotation queue](/langsmith/evaluation-concepts#annotation-queues).\n\n<img src=\"https://mintcdn.com/langchain-5e9cc07a/E8FdemkcQxROovD9/langsmith/images/add-to-evaluator-queue.gif?s=3c457faaaf2c7f31425ba510a518260e\" alt=\"Add to evaluator queue\" data-og-width=\"1976\" width=\"1976\" data-og-height=\"1080\" height=\"1080\" data-path=\"langsmith/images/add-to-evaluator-queue.gif\" data-optimize=\"true\" data-opv=\"3\" />\n\nTo add any new experiments/runs to an existing annotation queue, head to the **Evaluators** tab, select the evaluator you are aligning and click **Add to Queue.**\n\n<Check>\n  Datasets should be representative of inputs and outputs you expect to see in production.\n\nWhile you don’t need to cover every possible scenario, it’s important to include examples across the full range of expected use cases. For example, if you're building a sports bot that answers questions about baseball, basketball, and football, your dataset should include at least one labeled example from each sport.\n</Check>\n\nLabel examples in the annotation queue by adding a feedback score. Once you've labeled an example, click **Add to Reference Dataset**.\n\n<Check>\n  If you have a large number of examples in your experiments, you don't need to label every example to get started. We recommend starting with at least 20 examples, you can always add more later. We recommend that the examples that you label are diverse (balanced in both 0 and 1 labels) to ensure that you're building a well rounded evaluator prompt.\n</Check>\n\n## 3. Test your evaluator prompt against the labeled examples\n\nOnce you have labeled examples, the next step is iterating on your evaluator prompt to mimic the labeled data as well as possible. This iteration is done in the **Evaluator Playground**.\n\nTo go to the evaluator playground: Click the **View evaluator** button on the top right of the evaluator queue. This will take you to the detail page of the evaluator you are aligning. Click the **Evaluator Playground** button to access the playground.\n\n<img src=\"https://mintcdn.com/langchain-5e9cc07a/0B2PFrFBMRWNccee/langsmith/images/evaluator-pg.gif?s=c8108ce3abc95ce756fcbd1b3726916d\" alt=\"Evaluator Playground\" data-og-width=\"1916\" width=\"1916\" data-og-height=\"1080\" height=\"1080\" data-path=\"langsmith/images/evaluator-pg.gif\" data-optimize=\"true\" data-opv=\"3\" />\n\nIn the evaluator playground you can create or edit your evaluator prompt and click **Start Alignment** to run it over the set of labeled examples that you created in Step 2. After running your evaluator, you'll see how its generated scores compare to your human labels. The alignment score is the percentage of examples where the evaluator's judgment matches that of the human expert.\n\n## 4. Repeat to improve evaluator alignment\n\nIterate by updating your prompt and testing again to improve evaluator alignment.\n\n<Check>\n  Updates to your evaluator prompt are **not saved by default**. We reccomend saving your evaluator prompt regularly, and especially after you see your alignment score improve.\n\nThe evaluator playground will show the alignment score for the most recently saved version of your evaluator prompt for comparison when you're iterating on your prompt.\n</Check>\n\nImproving the alignment score of your evaluator isn't an exact science but there are a few strategies that are helpful in increasing the alignment score.\n\n### Tips for improving evaluator alignment\n\n**1. Investigate misaligned examples**\n\nDigging into misaligned examples and trying to group them into common failure modes is a great first step for improving your evaluator alignment.\n\nOnce you have identified the common failure modes, add instructions to your evaluator prompt so the LLM knows about them. For example, you could explain that \"MFA stands for \"multi-factor authentication\" if you notice it not understanding that specific acronym. Or you could tell it that \"a good response will always contain at least 3 potential hotels to book\" if it is confused on what good/bad means in your evaluator's context.\n\n**2. Inspect the reasoning behind the LLM score**\n\nTo understand why the LLM scored an example the way it did, you can enable reasoning for your LLM-as-a-judge evaluator. Reasoning is helpful to understand the LLM's thought process and can help you identify common failure modes to incorporate into your evaluator prompt as well..\n\nIn order to see the reasoning in the evaluator playground, hover over the LLM score.\n\n<img src=\"https://mintcdn.com/langchain-5e9cc07a/0B2PFrFBMRWNccee/langsmith/images/enable-reasoning.gif?s=d6ed09e4149a63723ef9305544b8b652\" alt=\"Enable reasoning\" data-og-width=\"1520\" width=\"1520\" data-og-height=\"1080\" height=\"1080\" data-path=\"langsmith/images/enable-reasoning.gif\" data-optimize=\"true\" data-opv=\"3\" />\n\nThis will show the reasoning behind the LLM's score in the evaluator playground.\n\n**3. Add more labeled examples and validate performance**\n\nTo avoid overfitting to the labeled examples, it's important to add more labeled examples and test performance, especially if you started off with a small number of examples.\n\n<iframe className=\"w-full aspect-video rounded-xl\" src=\"https://www.youtube.com/embed/-9o94oj4x0A?si=wfv9cN3L4DalMD2e\" title=\"YouTube video player\" frameBorder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowFullScreen />\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit this page on GitHub](https://github.com/langchain-ai/docs/edit/main/src/langsmith/improve-judge-evaluator-feedback.mdx) or [file an issue](https://github.com/langchain-ai/docs/issues/new/choose).\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "code_samples": [],
  "headings": [
    {
      "level": "h2",
      "text": "How it works",
      "id": "how-it-works"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "Offline evaluations",
      "id": "offline-evaluations"
    },
    {
      "level": "h3",
      "text": "Online evaluations",
      "id": "online-evaluations"
    },
    {
      "level": "h2",
      "text": "Getting started",
      "id": "getting-started"
    },
    {
      "level": "h2",
      "text": "1. Select experiments or runs",
      "id": "1.-select-experiments-or-runs"
    },
    {
      "level": "h2",
      "text": "2. Label examples",
      "id": "2.-label-examples"
    },
    {
      "level": "h2",
      "text": "3. Test your evaluator prompt against the labeled examples",
      "id": "3.-test-your-evaluator-prompt-against-the-labeled-examples"
    },
    {
      "level": "h2",
      "text": "4. Repeat to improve evaluator alignment",
      "id": "4.-repeat-to-improve-evaluator-alignment"
    },
    {
      "level": "h3",
      "text": "Tips for improving evaluator alignment",
      "id": "tips-for-improving-evaluator-alignment"
    },
    {
      "level": "h2",
      "text": "Video guide",
      "id": "video-guide"
    }
  ],
  "url": "llms-txt#improve-llm-as-judge-evaluators-using-human-feedback",
  "links": []
}