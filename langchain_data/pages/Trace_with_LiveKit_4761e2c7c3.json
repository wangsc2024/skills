{
  "title": "Trace with LiveKit",
  "content": "Source: https://docs.langchain.com/langsmith/trace-with-livekit\n\nLangSmith can capture traces generated by [LiveKit Agents](https://docs.livekit.io/agents/) using OpenTelemetry instrumentation. This guide shows you how to automatically capture traces from your LiveKit voice AI agents and send them to LangSmith for monitoring and analysis.\n\nFor a complete implementation, see the [demo repository](https://github.com/langchain-ai/voice-agents-tracing).\n\nInstall the required packages:\n\n## Quickstart tutorial\n\nFollow this step-by-step tutorial to create a voice AI agent with LiveKit and LangSmith tracing. You'll build a complete working example by copying and pasting code snippets.\n\n### Step 1: Set up your environment\n\nCreate a `.env` file in your project directory:\n\n### Step 2: Download the span processor\n\nAdd the [custom span processor file](https://github.com/langchain-ai/voice-agents-tracing/blob/main/livekit/langsmith_processor.py) that enables LangSmith tracing. Save it as `langsmith_processor.py` in your project directory.\n\n<Accordion title=\"What does the span processor do?\">\n  The span processor enriches LiveKit Agents' OpenTelemetry spans with LangSmith-compatible attributes so your traces display properly in LangSmith.\n\n* Converts LiveKit span types (stt, llm, tts, agent, session, job) to LangSmith format.\n  * Adds `gen_ai.prompt.*` and `gen_ai.completion.*` attributes for message visualization.\n  * Tracks and aggregates conversation messages across turns\n  * Uses multiple extraction strategies to handle various LiveKit attribute formats.\n\nThe processor automatically activates when you import it in your code.\n</Accordion>\n\n### Step 3: Create your voice agent file\n\nCreate a new file called `agent.py` and add the following code. We'll build it section by section so you can copy and paste each part.\n\n#### Part 1: Import dependencies and set up tracing\n\n```python  theme={null}\nimport sys\nimport os\nfrom pathlib import Path\nfrom dotenv import load_dotenv",
  "code_samples": [
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "</CodeGroup>\n\n## Quickstart tutorial\n\nFollow this step-by-step tutorial to create a voice AI agent with LiveKit and LangSmith tracing. You'll build a complete working example by copying and pasting code snippets.\n\n### Step 1: Set up your environment\n\nCreate a `.env` file in your project directory:",
      "language": "unknown"
    },
    {
      "code": "### Step 2: Download the span processor\n\nAdd the [custom span processor file](https://github.com/langchain-ai/voice-agents-tracing/blob/main/livekit/langsmith_processor.py) that enables LangSmith tracing. Save it as `langsmith_processor.py` in your project directory.\n\n<Accordion title=\"What does the span processor do?\">\n  The span processor enriches LiveKit Agents' OpenTelemetry spans with LangSmith-compatible attributes so your traces display properly in LangSmith.\n\n  **Key functions:**\n\n  * Converts LiveKit span types (stt, llm, tts, agent, session, job) to LangSmith format.\n  * Adds `gen_ai.prompt.*` and `gen_ai.completion.*` attributes for message visualization.\n  * Tracks and aggregates conversation messages across turns\n  * Uses multiple extraction strategies to handle various LiveKit attribute formats.\n\n  The processor automatically activates when you import it in your code.\n</Accordion>\n\n### Step 3: Create your voice agent file\n\nCreate a new file called `agent.py` and add the following code. We'll build it section by section so you can copy and paste each part.\n\n#### Part 1: Import dependencies and set up tracing",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Installation",
      "id": "installation"
    },
    {
      "level": "h2",
      "text": "Quickstart tutorial",
      "id": "quickstart-tutorial"
    },
    {
      "level": "h3",
      "text": "Step 1: Set up your environment",
      "id": "step-1:-set-up-your-environment"
    },
    {
      "level": "h3",
      "text": "Step 2: Download the span processor",
      "id": "step-2:-download-the-span-processor"
    },
    {
      "level": "h3",
      "text": "Step 3: Create your voice agent file",
      "id": "step-3:-create-your-voice-agent-file"
    }
  ],
  "url": "llms-txt#trace-with-livekit",
  "links": []
}