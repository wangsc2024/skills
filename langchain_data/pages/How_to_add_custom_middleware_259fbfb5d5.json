{
  "title": "How to add custom middleware",
  "content": "Source: https://docs.langchain.com/langsmith/custom-middleware\n\nWhen deploying agents to LangSmith, you can add custom middleware to your server to handle concerns like logging request metrics, injecting or checking headers, and enforcing security policies without modifying core server logic. This works the same way as [adding custom routes](/langsmith/custom-routes). You just need to provide your own [`Starlette`](https://www.starlette.io/applications/) app (including [`FastAPI`](https://fastapi.tiangolo.com/), [`FastHTML`](https://fastht.ml/) and other compatible apps).\n\nAdding middleware lets you intercept and modify requests and responses globally across your deployment, whether they're hitting your custom endpoints or the built-in LangSmith APIs.\n\nBelow is an example using FastAPI.\n\n<Note>\n  \"Python only\"\n  We currently only support custom middleware in Python deployments with `langgraph-api>=0.0.26`.\n</Note>\n\nStarting from an **existing** LangSmith application, add the following middleware code to your `webapp.py` file. If you are starting from scratch, you can create a new app from a template using the CLI.\n\nOnce you have a LangGraph project, add the following app code:\n\n```python {highlight={5}} theme={null}",
  "code_samples": [
    {
      "code": "Once you have a LangGraph project, add the following app code:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Create app",
      "id": "create-app"
    }
  ],
  "url": "llms-txt#how-to-add-custom-middleware",
  "links": []
}