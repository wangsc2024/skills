{
  "title": "We set up a `secret` query parameter",
  "content": "def f(data: dict, secret: str = Query(...)):\n    # You can import dependencies you don't have locally inside Modal functions\n    from langsmith import Client\n\n# First, we validate the secret key we pass\n    import os\n\nif secret != os.environ[\"LS_WEBHOOK\"]:\n        raise HTTPException(\n            status_code=status.HTTP_401_UNAUTHORIZED,\n            detail=\"Incorrect bearer token\",\n            headers={\"WWW-Authenticate\": \"Bearer\"},\n        )\n\n# This is where we put the logic for what should happen inside this webhook\n    ls_client = Client()\n    runs = data[\"runs\"]\n    ids = [r[\"id\"] for r in runs]\n    feedback = list(ls_client.list_feedback(run_ids=ids))\n    for r, f in zip(runs, feedback):\n        try:\n            ls_client.create_example(\n                inputs=r[\"inputs\"],\n                outputs={\"output\": f.correction},\n                dataset_name=\"classifier-github-issues\",\n            )\n        except Exception:\n            raise ValueError(f\"{r} and {f}\")\n    # Function body\n    return \"success!\"\n\nâœ“ Created objects.\nâ”œâ”€â”€ ðŸ”¨ Created mount /Users/harrisonchase/workplace/langsmith-docs/example-webhook.py\nâ”œâ”€â”€ ðŸ”¨ Created mount PythonPackage:langsmith\nâ””â”€â”€ ðŸ”¨ Created f => https://hwchase17--auth-example-f.modal.run\nâœ“ App deployed! ðŸŽ‰\n\nView Deployment: https://modal.com/apps/hwchase17/auth-example\n\nhttps://hwchase17--auth-example-f-dev.modal.run?secret={SECRET}\n```\n\nReplace `{SECRET}` with the secret key you created to access the Modal service.\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit this page on GitHub](https://github.com/langchain-ai/docs/edit/main/src/langsmith/webhooks.mdx) or [file an issue](https://github.com/langchain-ai/docs/issues/new/choose).\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "code_samples": [
    {
      "code": "We can now deploy this easily with `modal deploy ...` (see docs [here](https://modal.com/docs/guide/managing-deployments)).\n\nYou should now get something like:",
      "language": "unknown"
    },
    {
      "code": "The important thing to remember is `https://hwchase17--auth-example-f.modal.run` - the function we created to run.\nNOTE: this is NOT the final deployment URL, make sure not to accidentally use that.\n\n### Hooking it up\n\nWe can now take the function URL we create above and add it as a webhook.\nWe have to remember to also pass in the secret key as a query parameter.\nPutting it all together, it should look something like:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h3",
      "text": "Hooking it up",
      "id": "hooking-it-up"
    }
  ],
  "url": "llms-txt#we-set-up-a-`secret`-query-parameter",
  "links": []
}